(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{110:function(e,t){},115:function(e,t,a){},117:function(e,t,a){},123:function(e,t,a){},125:function(e,t,a){},127:function(e,t,a){},129:function(e,t,a){},131:function(e,t,a){},133:function(e,t,a){},135:function(e,t,a){},137:function(e,t,a){e.exports=a.p+"static/media/king.bin"},138:function(e,t,a){e.exports=a.p+"static/media/pawn.bin"},139:function(e,t,a){e.exports=a.p+"static/media/queen.bin"},140:function(e,t,a){e.exports=a.p+"static/media/rook.bin"},141:function(e,t,a){},143:function(e,t,a){},145:function(e,t,a){},147:function(e,t,a){},149:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"makeMove",function(){return Q}),a.d(n,"gameEvent",function(){return $}),a.d(n,"automaticGameEvent",function(){return ee}),a.d(n,"sync",function(){return te}),a.d(n,"update",function(){return ae}),a.d(n,"reset",function(){return ne}),a.d(n,"undo",function(){return re}),a.d(n,"redo",function(){return oe});var r=a(1),o=a.n(r),s=a(65),i=a(151),c=a(150),l=a(66),u=a.n(l),p=a(5),h=a(20),d=a(152),m=function(e){var t=e.to,a=e.exact,n=e.strict,r=e.activeClassName,s=e.className,i=e.activeStyle,l=e.style,u=e.isActive,m=Object(h.a)(e,["to","exact","strict","activeClassName","className","activeStyle","style","isActive"]);return o.a.createElement(c.a,{path:"object"===typeof t?t.pathname:t,exact:a,strict:n},function(e){var a=e.location,n=e.match,c=!!(u?u(n,a):n);return o.a.createElement("li",{className:c?[r,s].join(" "):s,style:c?Object(p.a)({},l,i):l},o.a.createElement(d.a,Object.assign({to:t},m)))})},f=a(6),v=a(7),y=a(9),b=a(8),g=a(10),O=a(3),j=a(4),k=a(2),E=a.n(k),C=a(0),x=a.n(C),w=a(11),D=a.n(w),M=a(14),I=a(22),P=a.n(I);var _=function(e){return E.a.createElement("div",{className:"gameinfo-item"},E.a.createElement("strong",null,e.name," "),E.a.createElement("div",null,JSON.stringify(e.value)))};_.propTypes={name:x.a.string.isRequired,value:x.a.any};var S=function(e){return E.a.createElement("section",{className:"gameinfo"},E.a.createElement(_,{name:"gameID",value:e.gameID}),E.a.createElement(_,{name:"playerID",value:e.playerID}),E.a.createElement(_,{name:"isActive",value:e.isActive}),e.isMultiplayer&&E.a.createElement("span",null,E.a.createElement(_,{name:"isConnected",value:e.isConnected}),E.a.createElement(_,{name:"isMultiplayer",value:e.isMultiplayer})))};S.propTypes={gameID:x.a.string,playerID:x.a.string,isActive:x.a.bool,isConnected:x.a.bool,isMultiplayer:x.a.bool};a(37);var L=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{active:!1}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"deactivate",function(){a.setState({active:!1})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"activate",function(){a.setState({active:!0}),a.props.onPress&&(a.props.onPress(),a.setState({active:!1}))}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;P.a.bind(this.props.value,function(t){t.preventDefault(),e.activate()})}},{key:"componentWillUnmount",value:function(){P.a.unbind(this.props.value)}},{key:"render",value:function(){var e=this.props.children;typeof this.props.children===typeof this&&(e=E.a.cloneElement(this.props.children,{active:this.state.active,deactivate:this.deactivate,activate:this.activate}));var t="key";return this.state.active&&(t+=" active"),E.a.createElement("div",{className:t},E.a.createElement("div",{className:"key-box",onClick:this.activate},this.props.value),E.a.createElement("div",{className:"key-child"},e))}}]),t}(E.a.Component);Object(j.a)(L,"propTypes",{value:x.a.string.isRequired,children:x.a.any,onPress:x.a.func});var N=function(e){var t=null;e.step&&(t=[E.a.createElement(L,{key:"4",value:"4",onPress:e.step},"step"),E.a.createElement(L,{key:"5",value:"5",onPress:e.simulate},"simulate")]);var a="controls";e.dockTop&&(a+=" docktop"),e.help&&(a+=" help");var n=e.help&&!e.dockTop?"block":"none";return E.a.createElement("section",{id:"debug-controls",style:null,className:a},E.a.createElement(L,{value:"1",onPress:e.reset},"reset"),E.a.createElement(L,{value:"2",onPress:e.save},"save"),E.a.createElement(L,{value:"3",onPress:e.restore},"restore"),t,e.dockTop||E.a.createElement(L,{value:"?",onPress:e.toggleHelp},"show more"),E.a.createElement("div",{className:"key",style:{display:n}},E.a.createElement("div",{className:"key-box"},"d")," show/hide this pane"),E.a.createElement("div",{className:"key",style:{display:n}},E.a.createElement("div",{className:"key-box"},"l")," show/hide log"),E.a.createElement("div",{className:"key",style:{display:n}},E.a.createElement("div",{className:"key-box"},"i")," show/hide game info tab"),E.a.createElement("div",{className:"key",style:{display:n}},E.a.createElement("div",{className:"key-box"},"t")," dock controls"))};N.propTypes={help:x.a.bool,toggleHelp:x.a.func,step:x.a.func,simulate:x.a.func,reset:x.a.func,save:x.a.func,restore:x.a.func,dockTop:x.a.bool};var T=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(e){var t=e==a.props.playerID?null:e;a.props.onClick(t)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=function(a){var n=a+"",r="player";n===e.props.ctx.currentPlayer&&(r+=" current"),n===e.props.playerID&&(r+=" active"),t.push(E.a.createElement("div",{className:r,key:a,onClick:function(){return e.onClick(n)}},n))},n=0;n<this.props.ctx.numPlayers;n++)a(n);return E.a.createElement("div",{className:"player-box"},t)}}]),t}(E.a.Component);Object(j.a)(T,"propTypes",{ctx:x.a.any.isRequired,playerID:x.a.any,onClick:x.a.func});var G=function(){};function A(e){G("ERROR:",e)}var R=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{error:""}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onSubmit",function(e){var t="";try{var n=new Function("return [".concat(e,"]"))();a.props.fn.apply(Object(O.a)(Object(O.a)(a)),n)}catch(r){t=""+r,A(r)}a.setState({error:t,focus:!1,enterArg:!1})}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return E.a.createElement("div",null,E.a.createElement(L,{value:this.props.shortcut},E.a.createElement(z,{name:this.props.name,onSubmit:this.onSubmit})),this.state.error?E.a.createElement("span",{className:"move-error"},this.state.error):null)}}]),t}(E.a.Component);Object(j.a)(R,"propTypes",{name:x.a.string.isRequired,shortcut:x.a.string.isRequired,fn:x.a.func.isRequired});var z=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onKeyDown",function(e){if("Enter"==e.key){e.preventDefault();var t=a.span.innerText;a.props.onSubmit(t),a.span.innerText="",a.props.deactivate()}"Escape"==e.key&&(e.preventDefault(),a.props.deactivate())}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(){this.props.active?this.span.focus():this.span.blur()}},{key:"render",value:function(){var e=this,t="move";return this.props.active&&(t+=" active"),E.a.createElement("div",{className:t,onClick:this.props.activate},this.props.name,"(",E.a.createElement("span",{ref:function(t){e.span=t},className:"arg-field",onBlur:this.props.deactivate,onKeyDown:this.onKeyDown,contentEditable:!0}),")")}}]),t}(E.a.Component);Object(j.a)(z,"propTypes",{name:x.a.string.isRequired,onSubmit:x.a.func.isRequired,active:x.a.bool,activate:x.a.func,deactivate:x.a.func});var q="MAKE_MOVE",F="GAME_EVENT",U="REDO",B="RESET",H="SYNC",W="UNDO",Y="UPDATE",V=(a(88),function(e){var t=void 0!==e.payload?JSON.stringify(e.payload,null,4):"";return E.a.createElement("div",null,t)});V.propTypes={payload:x.a.any};var Z=function(e){var t=e.action,a=t.payload.args||[],n=t.payload.playerID,r="log-event player".concat(n);e.pinned&&(r+=" pinned");var o=void 0!==e.payloadComponent?E.a.createElement(e.payloadComponent,{payload:e.payload}):E.a.createElement(V,{payload:e.payload});return E.a.createElement("div",{className:r,onClick:function(){return e.onLogClick(e.logIndex)},onMouseEnter:function(){return e.onMouseEnter(e.logIndex)},onMouseLeave:function(){return e.onMouseLeave()}},E.a.createElement("div",null,t.payload.type,"(",a.join(","),")"),o)};Z.propTypes={action:x.a.any.isRequired,logIndex:x.a.number.isRequired,onLogClick:x.a.func.isRequired,onMouseEnter:x.a.func.isRequired,onMouseLeave:x.a.func.isRequired,pinned:x.a.bool,payload:x.a.object,payloadComponent:x.a.oneOfType([x.a.element,x.a.func])};var J=function(e){return E.a.createElement("div",{className:"turn-marker",style:{gridRow:"span "+e.numEvents}},e.turn)};J.propTypes={turn:x.a.number.isRequired,numEvents:x.a.number.isRequired};var X=function(e){return E.a.createElement("div",{className:"phase-marker",style:{gridRow:"span "+e.numEvents}},e.phase)};X.propTypes={phase:x.a.string.isRequired,numEvents:x.a.number.isRequired};var K=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{pinned:null}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"rewind",function(e){for(var t=a.props.initialState,n=0;n<=e;n++){var r=a.props.log[n].action;r.automatic||(t=a.props.reducer(t,r))}return{G:t.G,ctx:t.ctx}}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onLogClick",function(e){a.setState(function(t){var n=a.rewind(e),r=a.props.log[e].action.payload.metadata;return t.pinned===e?(a.props.onHover({logIndex:e,state:n,metadata:void 0}),{pinned:null}):(a.props.onHover({logIndex:e,state:n,metadata:r}),{pinned:e})})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseEnter",function(e){if(null===a.state.pinned){var t=a.rewind(e);a.props.onHover({logIndex:e,state:t})}}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseLeave",function(){null===a.state.pinned&&a.props.onHover({state:null})}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){for(var e=[],t=[],a=[],n=0,r=0,o=this.props.initialState,s=0,i=0;i<this.props.log.length;i++){(u=this.props.log[i].action).type!=q&&u.automatic||(s=i)}for(var c=0;c<this.props.log.length;c++){var l=this.props.log[c],u=l.action,p=l.payload,h=o.ctx.turn,d=o.ctx.phase;u.type==q&&(e.push(E.a.createElement(Z,{key:c,pinned:c===this.state.pinned,logIndex:c,onLogClick:this.onLogClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,action:u,payload:p,payloadComponent:this.props.payloadComponent})),r++,n++),u.automatic||((o=this.props.reducer(o,u)).ctx.turn==h&&void 0===o.ctx.gameover&&c!=s||(t.push(E.a.createElement(J,{key:t.length,turn:h,numEvents:r})),r=0),o.ctx.phase==d&&void 0===o.ctx.gameover&&c!=s||(a.push(E.a.createElement(X,{key:a.length,phase:d,numEvents:n})),n=0))}var m="gamelog";return null!==this.state.pinned&&(m+=" pinned"),E.a.createElement("div",{className:m},t,e,a)}}]),t}(E.a.Component);Object(j.a)(K,"propTypes",{onHover:x.a.func,reducer:x.a.func,initialState:x.a.any.isRequired,log:x.a.array.isRequired,payloadComponent:x.a.oneOfType([x.a.element,x.a.func])}),Object(j.a)(K,"defaultProps",{onHover:function(){}});var Q=function(e,t,a,n){return{type:q,payload:{type:e,args:t,playerID:a,credentials:n}}},$=function(e,t,a,n){return{type:F,payload:{type:e,args:t,playerID:a,credentials:n}}},ee=function(e,t,a,n){return{type:F,payload:{type:e,args:t,playerID:a,credentials:n},automatic:!0}},te=function(e,t){return{type:H,state:e,log:t,clientOnly:!0}},ae=function(e,t){return{type:Y,state:e,deltalog:t,clientOnly:!0}},ne=function(e){return{type:B,state:e,clientOnly:!0}},re=function(){return{type:W}},oe=function(){return{type:U}},se=a(27);var ie=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"saveState",function(){var e=Object(se.b)(a.props.gamestate);window.localStorage.setItem("gamestate",e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"restoreState",function(){var e=window.localStorage.getItem("gamestate");if(null!==e){var t=Object(se.a)(e);a.props.store.dispatch(te(t))}}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClickMain",function(){a.setState({showLog:!1})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClickLog",function(){a.setState({showLog:!0})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"toggleHelp",function(){a.setState(function(e){return{help:!e.help}})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onLogHover",function(e){var t=e.state,n=e.metadata;a.setState({AIMetadata:n}),a.props.overrideGameState(t)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"simulate",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return function(){var n=Object(M.a)(D.a.mark(function n(){var r;return D.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:r=0;case 1:if(!(r<e)){n.next=12;break}return n.next=4,a.props.step();case 4:if(n.sent){n.next=7;break}return n.abrupt("break",12);case 7:return n.next=9,new Promise(function(e){return setTimeout(e,t)});case 9:r++,n.next=1;break;case 12:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}()()}),a.shortcuts=function(e,t,a){var n={},r={};for(var o in e)r[o]=o;for(var s in t)r[s]=s;for(var i={},c=0;c<a.length;c++)i[a[c]]=!0;var l=i,u=!0;for(var p in r){var h=p[0];if(l[h]){u=!1;break}l[h]=!0,n[p]=h}if(u)return n;l=i;var d=97;for(var m in n={},r){for(var f=String.fromCharCode(d);l[f];)d++,f=String.fromCharCode(d);l[f]=!0,n[m]=f}return n}(e.moves,e.events,"dlit"),a.state={showDebugUI:!0,showLog:!1,showGameInfo:e.showGameInfo,dockControls:e.dockControls,help:!1,AIMetadata:null},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;P.a.bind("d",function(t){t.preventDefault(),e.setState(function(e){return{showDebugUI:!e.showDebugUI}})}),P.a.bind("l",function(t){t.preventDefault(),e.setState(function(e){return{showLog:!e.showLog}})}),P.a.bind("i",function(t){t.preventDefault(),e.setState(function(e){return{showGameInfo:!e.showGameInfo}})}),P.a.bind("t",function(t){t.preventDefault(),e.setState(function(e){return{dockControls:!e.dockControls}})})}},{key:"componentWillUnmount",value:function(){P.a.unbind("d"),P.a.unbind("l")}},{key:"render",value:function(){if(!this.state.showDebugUI)return null;var e=[];for(var t in this.props.moves){var a=this.props.moves[t],n=this.shortcuts[t];e.push(E.a.createElement(R,{key:t,name:t,fn:a,shortcut:n}))}var r=[];for(var o in this.props.events){var s=this.props.events[o],i=this.shortcuts[o];r.push(E.a.createElement(R,{key:o,name:o,fn:s,shortcut:i}))}var c=this.state.AIMetadata&&this.props.visualizeAI,l="debug-ui";return this.state.dockControls&&(l+=" docktop"),E.a.createElement("div",{className:l},c&&E.a.createElement("div",{className:"ai-visualization"},this.props.visualizeAI(this.state.AIMetadata)),E.a.createElement("div",{className:"pane"},E.a.createElement("div",{className:"menu"},E.a.createElement("div",{className:this.state.showLog?"item":"item active",onClick:this.onClickMain},"Main"),E.a.createElement("div",{className:this.state.showLog?"item active":"item",onClick:this.onClickLog},"Log")),this.state.showLog||E.a.createElement("span",null,this.state.showGameInfo&&E.a.createElement(S,{gameID:this.props.gameID,playerID:this.props.playerID,isActive:this.props.gamestate.isActive,isConnected:this.props.gamestate.isConnected,isMultiplayer:this.props.isMultiplayer}),E.a.createElement(N,{dockTop:this.state.dockControls,help:this.state.help,toggleHelp:this.toggleHelp,step:this.props.step,simulate:this.simulate,reset:this.props.reset,save:this.saveState,restore:this.restoreState}),E.a.createElement("h3",null,"Players"),E.a.createElement(T,{ctx:this.props.gamestate.ctx,playerID:this.props.playerID,onClick:this.props.updatePlayerID}),E.a.createElement("h3",null,"Moves"),E.a.createElement("section",null,e),E.a.createElement("h3",null,"Events"),E.a.createElement("section",null,r),E.a.createElement("section",null,E.a.createElement("pre",{className:"json"},E.a.createElement("strong",null,"G"),":"," ",JSON.stringify(this.props.gamestate.G,null,2))),E.a.createElement("section",null,E.a.createElement("pre",{className:"json"},E.a.createElement("strong",null,"ctx"),":"," ",JSON.stringify(function(e){var t={};for(var a in e)a.startsWith("_")||(t[a]=e[a]);return t}(this.props.gamestate.ctx),null,2)))),this.state.showLog&&E.a.createElement("section",null,E.a.createElement(K,{onHover:this.onLogHover,reducer:this.props.reducer,log:this.props.gamestate.log,initialState:this.props.gamestate._initial}))))}}]),t}(E.a.Component);Object(j.a)(ie,"propTypes",{gamestate:x.a.shape({G:x.a.any.isRequired,ctx:x.a.any.isRequired,log:x.a.array.isRequired,isActive:x.a.bool,isConnected:x.a.bool,_initial:x.a.any.isRequired}),gameID:x.a.string.isRequired,playerID:x.a.string,isMultiplayer:x.a.bool,moves:x.a.any,events:x.a.any,restore:x.a.func,showLog:x.a.bool,store:x.a.any,step:x.a.func,reset:x.a.func,reducer:x.a.func,overrideGameState:x.a.func,visualizeAI:x.a.func,updateGameID:x.a.func,updatePlayerID:x.a.func,updateCredentials:x.a.func,showGameInfo:x.a.bool,dockControls:x.a.bool}),Object(j.a)(ie,"defaultProps",{showGameInfo:!0,dockControls:!1});var ce=a(12),le=a(25),ue=a(42),pe=a.n(ue),he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.socket,n=t.socketOpts,r=t.store,o=t.gameID,s=t.playerID,i=t.gameName,c=t.numPlayers,l=t.server;Object(f.a)(this,e),this.server=l,this.socket=a,this.store=r,this.socketOpts=n,this.gameName=i||"default",this.gameID=o||"default",this.playerID=s||null,this.numPlayers=c||2,this.gameID=this.gameName+":"+this.gameID,this.isConnected=!1,this.callback=function(){}}return Object(v.a)(e,[{key:"onAction",value:function(e,t){this.socket.emit("update",t,e._stateID,this.gameID,this.playerID)}},{key:"connect",value:function(){var e=this;if(!this.socket)if(this.server){var t=this.server;-1==t.search(/^https?:\/\//)&&(t="http://"+this.server),this.socket=pe()(t+"/"+this.gameName,this.socketOpts)}else this.socket=pe()("/"+this.gameName,this.socketOpts);this.socket.on("update",function(t,a,n){var r=e.store.getState();if(t==e.gameID&&a._stateID>=r._stateID){var o=ae(a,n);e.store.dispatch(o)}}),this.socket.on("sync",function(t,a,n){if(t==e.gameID){var r=te(a,n);e.store.dispatch(r)}}),this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers),this.socket.on("connect",function(){e.isConnected=!0,e.callback()}),this.socket.on("disconnect",function(){e.isConnected=!1,e.callback()})}},{key:"subscribe",value:function(e){this.callback=e}},{key:"updateGameID",value:function(e){this.gameID=this.gameName+":"+e;var t=ne(null);this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}},{key:"updatePlayerID",value:function(e){this.playerID=e;var t=ne(null);this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}}]),e}(),de=function(){function e(){Object(f.a)(this,e),this.games=new Map}return Object(v.a)(e,[{key:"connect",value:function(){var e=Object(M.a)(D.a.mark(function e(){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.games.set(t,a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=Object(M.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.games.get(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"has",value:function(){var e=Object(M.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.games.has(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(){var e=Object(M.a)(D.a.mark(function e(t){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.games.has(t);case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:this.games.delete(t);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"list",value:function(){var e=Object(M.a)(D.a.mark(function e(){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ce.a,e.next=3,this.games.keys();case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();function me(e){var t=this,a=function(){var e=4022871197;return function(t){t=t.toString();for(var a=0;a<t.length;a++){var n=.02519603282416938*(e+=t.charCodeAt(a));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=a(" "),t.s1=a(" "),t.s2=a(" "),t.s0-=a(e),t.s0<0&&(t.s0+=1),t.s1-=a(e),t.s1<0&&(t.s1+=1),t.s2-=a(e),t.s2<0&&(t.s2+=1),a=null}function fe(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function ve(e,t){var a=new me(e),n=t&&t.state,r=a.next;return r.quick=r,n&&("object"==typeof n&&fe(n,a),r.state=function(){return fe(a,{})}),r}var ye=function(){function e(t){Object(f.a)(this,e),this.state=t._random||{seed:"0"}}return Object(v.a)(e,[{key:"update",value:function(e){var t=Object(p.a)({},e.ctx,{_random:this.state});return Object(p.a)({},e,{ctx:t})}},{key:"attach",value:function(e){return Object(p.a)({},e,{random:this._api()})}},{key:"_random",value:function(){var e,t=this.state,a=(e=void 0===t.prngstate?new ve(t.seed,{state:!0}):new ve("",{state:t.prngstate}))();return this.state=Object(p.a)({},t,{prngstate:e.state()}),a}},{key:"_api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},a={},n=function(n){var r=t[n];a[n]=function(t){return void 0===t?Math.floor(e()*r)+1:Object(ce.a)(new Array(t).keys()).map(function(){return Math.floor(e()*r)+1})}};for(var r in t)n(r);return Object(p.a)({},a,{Die:function(t,a){return void 0===t&&(t=6),void 0===a?Math.floor(e()*t)+1:Object(ce.a)(new Array(a).keys()).map(function(){return Math.floor(e()*t)+1})},Number:function(){return e()},Shuffle:function(t){for(var a=t.slice(0),n=t.length,r=0,o=new Array(n);n;){var s=n*e()|0;o[r++]=a[s],a[s]=a[--n]}return o}})}}]),e}();ye.detach=function(e){e.random;return Object(h.a)(e,["random"])},ye.seed=function(){return(+new Date).toString(36).slice(-10)};var be=function(){function e(t,a){Object(f.a)(this,e),this.flow=t,this.playerID=a,this.dispatch=[]}return Object(v.a)(e,[{key:"attach",value:function(e){var t=this,a={},n=!0,r=!1,o=void 0;try{for(var s,i=function(){var e=s.value;a[e]=function(){for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];t.dispatch.push({key:e,args:n})}},c=this.flow.eventNames[Symbol.iterator]();!(n=(s=c.next()).done);n=!0)i()}catch(l){r=!0,o=l}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return Object(p.a)({},e,{events:a})}},{key:"update",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=this.dispatch[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,i=ee(s.key,s.args,this.playerID);e=Object(p.a)({},e,this.flow.processGameEvent(e,i))}}catch(c){a=!0,n=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return e}}]),e}();be.detach=function(e){e.events;return Object(h.a)(e,["events"])};var ge=a(68),Oe=[{fnWrap:function(e){return Object(ge.a)(e)}}],je=function(e,t){var a=[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.fnWrap}).reduce(function(e,a){return(0,a.fnWrap)(e,t)},e);return function(e,n){e=function(e,t){return[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.G}).filter(function(e){return void 0!==e.G.preMove}).forEach(function(a){e=a.G.preMove(e,t)}),e}(e,t),n=function(e,t){return[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.ctx}).filter(function(e){return void 0!==e.ctx.preMove}).forEach(function(a){e=a.ctx.preMove(e,t)}),e}(n,t);for(var r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];return e=function(e,t){return[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.G}).filter(function(e){return void 0!==e.G.postMove}).forEach(function(a){e=a.G.postMove(e,t)}),e}(e=a.apply(void 0,[e,n].concat(o)),t)}},ke={setup:function(e,t,a){return[].concat(Oe,Object(ce.a)(a.plugins)).filter(function(e){return void 0!==e.G}).filter(function(e){return void 0!==e.G.setup}).forEach(function(n){e=n.G.setup(e,t,a)}),e},onPhaseBegin:function(e,t,a){return[].concat(Oe,Object(ce.a)(a.plugins)).filter(function(e){return void 0!==e.G}).filter(function(e){return void 0!==e.G.onPhaseBegin}).forEach(function(n){e=n.G.onPhaseBegin(e,t,a)}),e}},Ee={setup:function(e,t){return[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.ctx}).filter(function(e){return void 0!==e.ctx.setup}).forEach(function(a){e=a.ctx.setup(e,t)}),e},onPhaseBegin:function(e,t){return[].concat(Oe,Object(ce.a)(t.plugins)).filter(function(e){return void 0!==e.ctx}).filter(function(e){return void 0!==e.ctx.onPhaseBegin}).forEach(function(a){e=a.ctx.onPhaseBegin(e,t)}),e}},Ce="INVALID_MOVE",xe=function(){function e(){Object(f.a)(this,e),this._payload=void 0}return Object(v.a)(e,[{key:"_api",value:function(){var e=this;return{setPayload:function(t){e._payload=t}}}},{key:"attach",value:function(e){return Object(p.a)({},e,{log:this._api()})}},{key:"update",value:function(e){if(void 0===this._payload)return e;var t=e.deltalog;return t[t.length-1]=Object(p.a)({},t[t.length-1],{payload:this._payload}),this._payload=void 0,Object(p.a)({},e,{deltalog:t})}}],[{key:"detach",value:function(e){e.log;return Object(h.a)(e,["log"])}}]),e}(),we=function(){function e(t,a,n){Object(f.a)(this,e),this.random=new ye(t),this.events=new be(a.flow,n),this.log=new xe}return Object(v.a)(e,[{key:"attachToContext",value:function(e){var t=this.random.attach(e);return t=this.events.attach(t),t=this.log.attach(t)}},{key:"_update",value:function(e,t){var a=t?this.events.update(e):e;return a=this.random.update(a),a=this.log.update(a)}},{key:"updateAndDetach",value:function(t,a){var n=this._update(t,a);return n.ctx=e.detachAllFromContext(n.ctx),n}}],[{key:"detachAllFromContext",value:function(e){var t=ye.detach(e);return t=be.detach(t),t=xe.detach(t)}}]),e}();function De(e){var t=e.game,a=e.numPlayers,n=e.setupData;a||(a=2);var r=t.flow.ctx(a),o=t.seed;void 0===o&&(o=ye.seed()),r._random={seed:o},r=Ee.setup(r,t);var s=new we(r,t,r.currentPlayer),i=s.attachToContext(r),c=t.setup(i,n),l={G:c=ke.setup(c,i,t),ctx:r,_undo:[],_redo:[],_stateID:0,_initial:{}},u=t.flow.init({G:l.G,ctx:i});l.G=u.G,l._undo=u._undo,u=s.updateAndDetach(u,!0),l.ctx=u.ctx;var p;return l._initial=(p=l,Object(se.a)(Object(se.b)(p))),l}function Me(e){var t=e.game,a=e.multiplayer;return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case F:if(e=Object(p.a)({},e,{deltalog:[]}),a)return e;if(null!==n.payload.playerID&&void 0!==n.payload.playerID&&!t.flow.canPlayerCallEvent(e.G,e.ctx,n.payload.playerID))return e;var r=new we(e.ctx,t,n.payload.playerID);e.ctx=r.attachToContext(e.ctx);var o=t.flow.processGameEvent(e,n);return o=r.updateAndDetach(o,!0),Object(p.a)({},o,{_stateID:e._stateID+1});case q:if(e=Object(p.a)({},e,{deltalog:[]}),!t.moveNames.includes(n.payload.type))return e;if(!t.flow.canMakeMove(e.G,e.ctx,n.payload.type))return e;if(null!==n.payload.playerID&&void 0!==n.payload.playerID&&!t.flow.canPlayerMakeMove(e.G,e.ctx,n.payload.playerID))return e;var s=new we(e.ctx,t,n.payload.playerID),i=s.attachToContext(e.ctx),c=t.processMove(e.G,n.payload,i);if(c===Ce)return e;var l=s.updateAndDetach(Object(p.a)({},e,{deltalog:[{action:n,_stateID:e._stateID}]}),!1),u=l.ctx;return a&&!t.flow.optimisticUpdate(c,u,n.payload)&&(c=e.G),e=Object(p.a)({},l,{G:c,ctx:u,_stateID:e._stateID+1}),a?e:(i=s.attachToContext(e.ctx),e=t.flow.processMove(Object(p.a)({},e,{ctx:i}),n.payload),e=s.updateAndDetach(e,!0));case B:case Y:case H:return n.state;case W:var h=e,d=h._undo,m=h._redo;if(d.length<2)return e;var f=d[d.length-1],v=d[d.length-2];return t.flow.canUndoMove(e.G,e.ctx,f.moveType)?Object(p.a)({},e,{G:v.G,ctx:v.ctx,_undo:d.slice(0,d.length-1),_redo:[f].concat(Object(ce.a)(m))}):e;case U:var y=e,b=y._undo,g=y._redo;if(0==g.length)return e;var O=g[0];return Object(p.a)({},e,{G:O.G,ctx:O.ctx,_undo:[].concat(Object(ce.a)(b),[O]),_redo:g.slice(1)});default:return e}}}function Ie(e,t,a){return void 0===e||void 0===t?t:t.map(function(t){if(null!==a&&+a===+t.action.payload.playerID)return t;if("MAKE_MOVE"!==t.action.type)return t;var n=t.action.payload.type,r=t;if(e.includes(n)){var o=Object(p.a)({},r.action.payload,{args:void 0,argsRedacted:!0});r=Object(p.a)({},r,{action:Object(p.a)({},r.action,{payload:o})})}return r})}var Pe=function(){function e(t,a,n,r){Object(f.a)(this,e),this.game=t,this.storageAPI=a,this.transportAPI=n,this.isActionFromAuthenticPlayer=function(){return!0},void 0!==r&&(this.isActionFromAuthenticPlayer=r)}return Object(v.a)(e,[{key:"onUpdate",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a,n,r){var o,s,i,c,l,u,h=this;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n,e.next=3,this.storageAPI.get(o);case 3:if(void 0!==(s=e.sent)){e.next=7;break}return A("game not found, gameID=[".concat(o,"]")),e.abrupt("return",{error:"game not found"});case 7:return i=Me({game:this.game,numPlayers:s.ctx.numPlayers}),c=Object(le.c)(i,s),e.next=11,this.isActionFromAuthenticPlayer({action:t,db:this.storageAPI,gameID:n,playerID:r});case 11:if(e.sent){e.next=14;break}return e.abrupt("return",{error:"unauthorized action"});case 14:if(t.type!=q||this.game.flow.canPlayerMakeMove(s.G,s.ctx,r)){e.next=17;break}return A("move not processed - canPlayerMakeMove=false, playerID=[".concat(r,"]")),e.abrupt("return");case 17:if(t.type!=F||this.game.flow.canPlayerCallEvent(s.G,s.ctx,r)){e.next=20;break}return A("event not processed - invalid playerID=[".concat(r,"]")),e.abrupt("return");case 20:if(s._stateID===a){e.next=23;break}return A("invalid stateID, was=[".concat(a,"], expected=[").concat(s._stateID,"]")),e.abrupt("return");case 23:return l=c.getState().log||[],c.dispatch(t),s=c.getState(),this.transportAPI.sendAll(function(e){var t=Object(p.a)({},s,{G:h.game.playerView(s.G,s.ctx,e),ctx:Object(p.a)({},s.ctx,{_random:void 0}),log:void 0,deltalog:void 0}),a=Ie(h.game.flow.redactedMoves,s.deltalog,e);return{type:"update",args:[n,t,a]}}),l=[].concat(Object(ce.a)(l),Object(ce.a)(s.deltalog)),u=Object(p.a)({},s,{log:l}),e.next=31,this.storageAPI.set(o,u);case 31:case"end":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"onSync",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a,n){var r,o,s,i;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,e.next=3,this.storageAPI.get(r);case 3:if(void 0!==(o=e.sent)){e.next=11;break}return o=De({game:this.game,numPlayers:n}),e.next=8,this.storageAPI.set(r,o);case 8:return e.next=10,this.storageAPI.get(r);case 10:o=e.sent;case 11:return s=Object(p.a)({},o,{G:this.game.playerView(o.G,o.ctx,a),ctx:Object(p.a)({},o.ctx,{_random:void 0}),log:void 0,deltalog:void 0}),i=Ie(this.game.flow.redactedMoves,o.log,a),this.transportAPI.send({playerID:a,type:"sync",args:[t,s,i]}),e.abrupt("return");case 15:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()}]),e}();var _e=function(){function e(t){var a=t.master,n=t.store,r=t.gameID,o=t.playerID,s=t.gameName,i=t.numPlayers;Object(f.a)(this,e),this.master=a,this.store=n,this.gameName=s||"default",this.gameID=r||"default",this.playerID=o||null,this.numPlayers=i||2,this.gameID=this.gameName+":"+this.gameID,this.isConnected=!0}return Object(v.a)(e,[{key:"onUpdate",value:function(e,t,a){var n=this.store.getState();if(e==this.gameID&&t._stateID>=n._stateID){var r=ae(t,a);this.store.dispatch(r)}}},{key:"onSync",value:function(e,t,a){if(e==this.gameID){var n=te(t,a);this.store.dispatch(n)}}},{key:"onAction",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.master.onUpdate(a,t._stateID,this.gameID,this.playerID);case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(M.a)(D.a.mark(function e(){var t=this;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.master.connect(this.gameID,this.playerID,function(e){for(var a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];"sync"==e&&t.onSync.apply(t,n),"update"==e&&t.onUpdate.apply(t,n)}),e.next=3,this.master.onSync(this.gameID,this.playerID,this.numPlayers);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"subscribe",value:function(){}},{key:"updateGameID",value:function(){var e=Object(M.a)(D.a.mark(function e(t){var a;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.gameID=this.gameName+":"+t,a=ne(null),this.store.dispatch(a),e.next=5,this.master.onSync(this.gameID,this.playerID,this.numPlayers);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updatePlayerID",value:function(){var e=Object(M.a)(D.a.mark(function e(t){var a;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.playerID=t,a=ne(null),this.store.dispatch(a),e.next=5,this.master.onSync(this.gameID,this.playerID,this.numPlayers);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();function Se(e,t,a,r,o,s){return t.reduce(function(t,i){return t[i]=function(){var t=r;s||null!==r&&void 0!==r||(t=a.getState().ctx.currentPlayer);for(var c=arguments.length,l=new Array(c),u=0;u<c;u++)l[u]=arguments[u];a.dispatch(n[e](i,l,t,o))},t},{})}var Le=Se.bind(null,"gameEvent"),Ne=Se.bind(null,"makeMove"),Te=function(){function e(t){var a=this,n=t.game,r=t.ai,o=t.numPlayers,s=t.multiplayer,i=t.socketOpts,c=t.gameID,l=t.playerID,u=t.credentials,p=t.enhancer;if(Object(f.a)(this,e),this.game=n,this.playerID=l,this.gameID=c,this.credentials=u,this.multiplayer=s,this.subscribeCallback=function(){},this.reducer=Me({game:n,numPlayers:o,multiplayer:s}),void 0!==r&&void 0===s){var h=new r.bot({game:n,enumerate:r.enumerate});this.step=Object(M.a)(D.a.mark(function e(){var t,n,r,o,s;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.store.getState(),n=t.ctx.actionPlayers[0],e.next=4,h.play(t,n);case 4:return r=e.sent,o=r.action,s=r.metadata,o&&(o.payload.metadata=s,a.store.dispatch(o)),e.abrupt("return",o);case 9:case"end":return e.stop()}},e)}))}var d=null;void 0===s&&(d=De({game:n,numPlayers:o})),this.reset=function(){a.store.dispatch(ne(d))},this.undo=function(){a.store.dispatch(re())},this.redo=function(){a.store.dispatch(oe())},this.store=null,this.log=[];var m=function(e){return function(t){return function(n){var r=t(n),o=e.getState();switch(n.type){case q:case F:var s=o.deltalog;a.log=[].concat(Object(ce.a)(a.log),Object(ce.a)(s));break;case B:a.log=[];break;case Y:var i=-1;a.log.length>0&&(i=a.log[a.log.length-1]._stateID);var c=n.deltalog||[];c=c.filter(function(e){return e._stateID>i}),a.log=[].concat(Object(ce.a)(a.log),Object(ce.a)(c));break;case H:a.log=n.log||[]}return a.subscribeCallback(),r}}},v=function(e){return function(t){return function(n){var r=e.getState(),o=t(n);return 1!=n.clientOnly&&a.transport.onAction(r,n),o}}};p=void 0!==p?Object(le.b)(Object(le.a)(m,v),p):Object(le.a)(m,v),this.store=Object(le.c)(this.reducer,d,p),s&&void 0!==s.master_?this.transport=new _e({master:s.master_,store:this.store,gameID:c,playerID:l,gameName:n.name,numPlayers:o}):s&&void 0!==s.server?this.transport=new he({store:this.store,gameID:c,playerID:l,gameName:n.name,numPlayers:o,server:s.server,socketOpts:i}):s&&void 0!==s.transport?this.transport=s.transport:this.transport={isConnected:!0,onAction:function(){},subscribe:function(){},connect:function(){},updateGameID:function(){},updatePlayerID:function(){}},this.createDispatchers()}return Object(v.a)(e,[{key:"subscribe",value:function(e){var t=this,a=function(){return e(t.getState())};this.transport.subscribe(a),this.subscribeCallback=a}},{key:"getState",value:function(){var e=this.store.getState();if(null===e)return e;var t=!0,a=this.game.flow.canPlayerMakeMove(e.G,e.ctx,this.playerID);this.multiplayer&&!a&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||a||(t=!1),void 0!==e.ctx.gameover&&(t=!1);var n=this.game.playerView(e.G,e.ctx,this.playerID),r=Object(p.a)({},e,{isActive:t,G:n,log:this.log}),o=this.transport.isConnected;return r=Object(p.a)({},r,{isConnected:o})}},{key:"connect",value:function(){this.transport.connect()}},{key:"createDispatchers",value:function(){this.moves=Ne(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Le(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e)}},{key:"updateGameID",value:function(e){this.gameID=e,this.createDispatchers(),this.transport.updateGameID(e)}},{key:"updateCredentials",value:function(e){this.credentials=e,this.createDispatchers()}}]),e}();function Ge(e){var t=e.game,a=e.multiplayer;return a&&(1==a&&(a={server:""}),1==a.local&&(a.master_=function(e){var t={},a=function(e){var a=e.type,n=e.playerID,r=e.args,o=t[n];void 0!==o&&o.apply(null,[a].concat(Object(ce.a)(r)))},n=new Pe(e,new de,{send:a,sendAll:function(e){for(var n in t){var r=e(n),o=r.type,s=r.args;a({type:o,playerID:n,args:s})}}});return n.connect=function(e,a,n){t[a]=n},n}(t))),Object(p.a)({},e,{multiplayer:a})}function Ae(e){return new Te(e)}function Re(e){var t,a,n=Ge(e),r=n.game,o=n.numPlayers,s=n.loading,i=n.board,c=n.multiplayer,l=n.ai,u=n.debug,d=n.enhancer;if(void 0===s){s=function(){return E.a.createElement("div",{className:"bgio-loading"},"connecting...")}}return a=t=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{gameStateOverride:null}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"updateGameID",function(e){a.client.updateGameID(e),a.gameID=e,a.forceUpdate()}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"updatePlayerID",function(e){a.client.updatePlayerID(e),a.playerID=e,a.forceUpdate()}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"updateCredentials",function(e){a.client.updateCredentials(e),a.credentials=e,a.forceUpdate()}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"overrideGameState",function(e){a.setState({gameStateOverride:e})}),a.client=Ae({game:r,ai:l,numPlayers:o,multiplayer:c,gameID:e.gameID,playerID:e.playerID,credentials:e.credentials,enhancer:d}),a.gameID=e.gameID,a.playerID=e.playerID,a.credentials=e.credentials,a.client.subscribe(function(){return a.forceUpdate()}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.gameID!=e.gameID&&this.updateGameID(this.props.gameID),this.props.playerID!=e.playerID&&this.updatePlayerID(this.props.playerID),this.props.credentials!=e.credentials&&this.updateCredentials(this.props.credentials)}},{key:"componentDidMount",value:function(){this.client.connect()}},{key:"render",value:function(){var e=null,t=null,a=this.client.getState(),n=this.props,r=n.debug,o=Object(h.a)(n,["debug"]);if(this.state.gameStateOverride&&(a=Object(p.a)({},a,this.state.gameStateOverride)),null===a)return E.a.createElement(s);if(i&&(e=E.a.createElement(i,Object(p.a)({},a,o,{isMultiplayer:void 0!==c,moves:this.client.moves,events:this.client.events,gameID:this.gameID,playerID:this.playerID,step:this.client.step,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo}))),!1!==u&&r){var d="object"===typeof u&&u.showGameInfo,m="object"===typeof u&&u.dockControls;t=E.a.createElement(ie,{gamestate:a,reducer:this.client.reducer,store:this.client.store,isMultiplayer:void 0!==c,moves:this.client.moves,events:this.client.events,gameID:this.gameID,playerID:this.playerID,credentials:this.credentials,step:this.client.step,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,visualizeAI:l&&l.visualize,overrideGameState:this.overrideGameState,updateGameID:this.updateGameID,updatePlayerID:this.updatePlayerID,updateCredentials:this.updateCredentials,showGameInfo:d,dockControls:m})}return E.a.createElement("div",{className:"bgio-client"},t,e)}}]),t}(E.a.Component),Object(j.a)(t,"propTypes",{gameID:x.a.string,playerID:x.a.string,credentials:x.a.string,debug:x.a.any}),Object(j.a)(t,"defaultProps",{gameID:"default",playerID:null,credentials:null,debug:!0}),a}var ze=a(44),qe=a.n(ze),Fe=function(){function e(t){var a=t.server,n=t.gameComponents,r=t.playerName,o=t.playerCredentials;Object(f.a)(this,e),this.gameComponents=n,this.playerName=r||"Visitor",this.playerCredentials=o,this.server=a,this.gameInstances=[]}return Object(v.a)(e,[{key:"_baseUrl",value:function(){return"".concat(this.server||"","/games")}},{key:"refresh",value:function(){var e=Object(M.a)(D.a.mark(function e(){var t,a,n,r,o,s,i,c,l,u,p,h,d,m,f;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.gameInstances.length=0,e.next=4,fetch(this._baseUrl());case 4:if(200===(t=e.sent).status){e.next=7;break}throw new Error("HTTP status "+t.status);case 7:return e.next=9,t.json();case 9:a=e.sent,n=!0,r=!1,o=void 0,e.prev=13,s=a[Symbol.iterator]();case 15:if(n=(i=s.next()).done){e.next=48;break}if(c=i.value,this._getGameComponents(c)){e.next=19;break}return e.abrupt("continue",45);case 19:return e.next=21,fetch(this._baseUrl()+"/"+c);case 21:return l=e.sent,e.next=24,l.json();case 24:for(u=e.sent,p=!0,h=!1,d=void 0,e.prev=28,m=u.gameInstances[Symbol.iterator]();!(p=(f=m.next()).done);p=!0)f.value.gameName=c;e.next=36;break;case 32:e.prev=32,e.t0=e.catch(28),h=!0,d=e.t0;case 36:e.prev=36,e.prev=37,p||null==m.return||m.return();case 39:if(e.prev=39,!h){e.next=42;break}throw d;case 42:return e.finish(39);case 43:return e.finish(36);case 44:this.gameInstances=this.gameInstances.concat(u.gameInstances);case 45:n=!0,e.next=15;break;case 48:e.next=54;break;case 50:e.prev=50,e.t1=e.catch(13),r=!0,o=e.t1;case 54:e.prev=54,e.prev=55,n||null==s.return||s.return();case 57:if(e.prev=57,!r){e.next=60;break}throw o;case 60:return e.finish(57);case 61:return e.finish(54);case 62:e.next=67;break;case 64:throw e.prev=64,e.t2=e.catch(0),new Error("failed to retrieve list of games ("+e.t2+")");case 67:case"end":return e.stop()}},e,this,[[0,64],[13,50,54,62],[28,32,36,44],[37,,39,43],[55,,57,61]])}));return function(){return e.apply(this,arguments)}}()},{key:"_getGameInstance",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=this.gameInstances[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;if(s.gameID===e)return s}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"_getGameComponents",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=this.gameComponents[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;if(s.game.name===e)return s}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"_findPlayer",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o=this.gameInstances[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;if(s.players.some(function(t){return t.name===e}))return s}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"join",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a,n){var r,o,s;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=this._findPlayer(this.playerName))){e.next=4;break}throw new Error("player has already joined "+r.gameID);case 4:if(r=this._getGameInstance(a)){e.next=7;break}throw new Error("game instance "+a+" not found");case 7:return e.next=9,fetch(this._baseUrl()+"/"+t+"/"+a+"/join",{method:"POST",body:JSON.stringify({playerID:n,playerName:this.playerName}),headers:{"Content-Type":"application/json"}});case 9:if(200===(o=e.sent).status){e.next=12;break}throw new Error("HTTP status "+o.status);case 12:return e.next=14,o.json();case 14:s=e.sent,r.players[Number.parseInt(n)].name=this.playerName,this.playerCredentials=s.playerCredentials,e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(0),new Error("failed to join room "+a+" ("+e.t0+")");case 22:case"end":return e.stop()}},e,this,[[0,19]])}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"leave",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a){var n,r,o,s,i,c,l,u;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=this._getGameInstance(a)){e.next=4;break}throw new Error("game instance not found");case 4:r=!0,o=!1,s=void 0,e.prev=7,i=n.players[Symbol.iterator]();case 9:if(r=(c=i.next()).done){e.next=23;break}if((l=c.value).name!==this.playerName){e.next=20;break}return e.next=14,fetch(this._baseUrl()+"/"+t+"/"+a+"/leave",{method:"POST",body:JSON.stringify({playerID:l.id,playerCredentials:this.playerCredentials}),headers:{"Content-Type":"application/json"}});case 14:if(200===(u=e.sent).status){e.next=17;break}throw new Error("HTTP status "+u.status);case 17:return delete l.name,delete this.playerCredentials,e.abrupt("return");case 20:r=!0,e.next=9;break;case 23:e.next=29;break;case 25:e.prev=25,e.t0=e.catch(7),o=!0,s=e.t0;case 29:e.prev=29,e.prev=30,r||null==i.return||i.return();case 32:if(e.prev=32,!o){e.next=35;break}throw s;case 35:return e.finish(32);case 36:return e.finish(29);case 37:throw new Error("player not found in room");case 40:throw e.prev=40,e.t1=e.catch(0),new Error("failed to leave room "+a+" ("+e.t1+")");case 43:case"end":return e.stop()}},e,this,[[0,40],[7,25,29,37],[30,,32,36]])}));return function(t,a){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(M.a)(D.a.mark(function e(){var t;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._findPlayer(this.playerName))){e.next=4;break}return e.next=4,this.leave(t.gameName,t.gameID);case 4:this.gameInstances=[],this.playerName="Visitor";case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(M.a)(D.a.mark(function e(t,a){var n,r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=this._getGameComponents(t)){e.next=4;break}throw new Error("game not found");case 4:if(!(a<n.game.minPlayers||a>n.game.maxPlayers)){e.next=6;break}throw new Error("invalid number of players "+a);case 6:return e.next=8,fetch(this._baseUrl()+"/"+t+"/create",{method:"POST",body:JSON.stringify({numPlayers:a}),headers:{"Content-Type":"application/json"}});case 8:if(200===(r=e.sent).status){e.next=11;break}throw new Error("HTTP status "+r.status);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(0),new Error("failed to create room for "+t+" ("+e.t0+")");case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(t,a){return e.apply(this,arguments)}}()}]),e}();var Ue=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{playerName:a.props.playerName,nameErrorMsg:""}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClickEnter",function(){""!==a.state.playerName&&a.props.onEnter(a.state.playerName)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onKeyPress",function(e){"Enter"===e.key&&a.onClickEnter()}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onChangePlayerName",function(e){var t=e.target.value.trim();a.setState({playerName:t,nameErrorMsg:t.length>0?"":"empty player name"})}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return E.a.createElement("div",null,E.a.createElement("p",{className:"phase-title"},"Choose a player name:"),E.a.createElement("input",{type:"text",value:this.state.playerName,onChange:this.onChangePlayerName,onKeyPress:this.onKeyPress}),E.a.createElement("span",{className:"buttons"},E.a.createElement("button",{className:"buttons",onClick:this.onClickEnter},"Enter")),E.a.createElement("br",null),E.a.createElement("span",{className:"error-msg"},this.state.nameErrorMsg,E.a.createElement("br",null)))}}]),t}(E.a.Component);Object(j.a)(Ue,"propTypes",{playerName:x.a.string,onEnter:x.a.func.isRequired}),Object(j.a)(Ue,"defaultProps",{playerName:""});var Be=Ue,He=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createSeat",function(e){return e.name||"[free]"}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createInstanceButtons",function(e){var t=e.players.find(function(e){return e.name===a.props.playerName}),n=e.players.find(function(e){return!e.name});return t&&n?E.a.createElement("button",{onClick:function(){return a.props.onClickLeave(e.gameName,e.gameID)}},"Leave"):n?E.a.createElement("button",{onClick:function(){return a.props.onClickJoin(e.gameName,e.gameID,""+n.id)}},"Join"):t?E.a.createElement("button",{onClick:function(){return a.props.onClickPlay(e.gameName,{gameID:e.gameID,playerID:""+t.id,numPlayers:e.players.length})}},"Play"):E.a.createElement("button",{onClick:function(){return a.props.onClickPlay(e.gameName,{gameID:e.gameID,numPlayers:e.players.length})}},"Spectate")}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props.gameInstance,t="OPEN";return e.players.find(function(e){return!e.name})||(t="RUNNING"),E.a.createElement("tr",{key:"line-"+e.gameID},E.a.createElement("td",{key:"cell-name-"+e.gameID},e.gameName),E.a.createElement("td",{key:"cell-status-"+e.gameID},t),E.a.createElement("td",{key:"cell-seats-"+e.gameID},e.players.map(this._createSeat).join(", ")),E.a.createElement("td",{key:"cell-buttons-"+e.gameID},this._createInstanceButtons(e)))}}]),t}(E.a.Component);Object(j.a)(He,"propTypes",{gameInstance:x.a.shape({gameName:x.a.string.isRequired,gameID:x.a.string.isRequired,players:x.a.array.isRequired}),playerName:x.a.string.isRequired,onClickJoin:x.a.func.isRequired,onClickLeave:x.a.func.isRequired,onClickPlay:x.a.func.isRequired});var We=He,Ye=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{selectedGame:0,numPlayers:2}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createGameNameOption",function(e,t){return E.a.createElement("option",{key:"name-option-"+t,value:t},e.game.name)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createNumPlayersOption",function(e){return E.a.createElement("option",{key:"num-option-"+e,value:e},e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createNumPlayersRange",function(e){return e.minPlayers||(e.minPlayers=1),e.maxPlayers||(e.maxPlayers=4),console.assert(e.maxPlayers>=e.minPlayers),Object(ce.a)(new Array(e.maxPlayers+1).keys()).slice(e.minPlayers)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onChangeNumPlayers",function(e){a.setState({numPlayers:Number.parseInt(e.target.value)})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onChangeSelectedGame",function(e){var t=Number.parseInt(e.target.value);a.setState({selectedGame:t,numPlayers:a._createNumPlayersRange(a.props.games[t].game)[0]})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClickCreate",function(){a.props.createGame(a.props.games[a.state.selectedGame].game.name,a.state.numPlayers)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return E.a.createElement("div",null,E.a.createElement("select",{value:this.state.selectedGame,onChange:function(t){return e.onChangeSelectedGame(t)}},this.props.games.map(this._createGameNameOption)),E.a.createElement("span",null,"Players:"),E.a.createElement("select",{value:this.state.numPlayers,onChange:this.onChangeNumPlayers},this._createNumPlayersRange(this.props.games[this.state.selectedGame].game).map(this._createNumPlayersOption)),E.a.createElement("span",{className:"buttons"},E.a.createElement("button",{onClick:this.onClickCreate},"Create")))}}]),t}(E.a.Component);Object(j.a)(Ye,"propTypes",{games:x.a.array.isRequired,createGame:x.a.func.isRequired});var Ve=Ye,Ze={ENTER:"enter",PLAY:"play",LIST:"list"},Je=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{phase:Ze.ENTER,playerName:"Visitor",runningGame:null,errorMsg:"",credentialStore:{}}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createConnection",function(e){var t,n=a.state.playerName;a.connection=(t={server:e.lobbyServer,gameComponents:e.gameComponents,playerName:n,playerCredentials:a.state.credentialStore[n]},new Fe(t))}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_updateCredentials",function(e,t){a.setState(function(a){var n=Object.assign({},a.credentialStore);return n[[e]]=t,{credentialStore:n}})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_updateConnection",Object(M.a)(D.a.mark(function e(){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connection.refresh();case 2:a.forceUpdate();case 3:case"end":return e.stop()}},e)}))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_enterLobby",function(e){a.setState({playerName:e,phase:Ze.LIST})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_exitLobby",Object(M.a)(D.a.mark(function e(){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.connection.disconnect();case 2:a.setState({phase:Ze.ENTER,errorMsg:""});case 3:case"end":return e.stop()}},e)}))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_createRoom",function(){var e=Object(M.a)(D.a.mark(function e(t,n){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.connection.create(t,n);case 3:return e.next=5,a.connection.refresh();case 5:a.setState({}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a.setState({errorMsg:e.t0.message});case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_joinRoom",function(){var e=Object(M.a)(D.a.mark(function e(t,n,r){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.connection.join(t,n,r);case 3:return e.next=5,a.connection.refresh();case 5:a._updateCredentials(a.connection.playerName,a.connection.playerCredentials),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a.setState({errorMsg:e.t0.message});case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_leaveRoom",function(){var e=Object(M.a)(D.a.mark(function e(t,n){return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.connection.leave(t,n);case 3:return e.next=5,a.connection.refresh();case 5:a._updateCredentials(a.connection.playerName,a.connection.playerCredentials),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a.setState({errorMsg:e.t0.message});case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_startGame",function(e,t){var n=a.connection._getGameComponents(e);if(n){var r=void 0;t.numPlayers>1&&(r=!a.props.gameServer||{server:a.props.gameServer});var o={app:a.props.clientFactory({game:n.game,board:n.board,debug:a.props.debug,multiplayer:r}),gameID:t.gameID,playerID:t.numPlayers>1?t.playerID:null,credentials:a.connection.playerCredentials};a.setState({phase:Ze.PLAY,runningGame:o})}else a.setState({errorMsg:"game "+e+" not supported"})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_exitRoom",function(){a.setState({phase:Ze.LIST,runningGame:null})}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_getPhaseVisibility",function(e){return a.state.phase!==e?"hidden":"phase"}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"renderRooms",function(e,t){return e.map(function(e){var n=e.gameID,r=e.gameName,o=e.players;return E.a.createElement(We,{key:"instance-"+n,gameInstance:{gameID:n,gameName:r,players:Object.values(o)},playerName:t,onClickJoin:a._joinRoom,onClickLeave:a._leaveRoom,onClickPlay:a._startGame})})}),a._createConnection(a.props),a._updateConnection(),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=qe.a.load("lobbyState")||{};e.phase&&e.phase===Ze.PLAY&&(e.phase=Ze.LIST),this.setState({phase:e.phase||Ze.ENTER,playerName:e.playerName||"Visitor",credentialStore:e.credentialStore||{}})}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.playerName,n=this.state.credentialStore[a];if(t.phase!==this.state.phase||t.credentialStore[a]!==n||t.playerName!==a){this._createConnection(this.props),this._updateConnection();var r={phase:this.state.phase,playerName:a,credentialStore:this.state.credentialStore};qe.a.save("lobbyState",r,{path:"/"})}}},{key:"render",value:function(){var e=this.props,t=e.gameComponents,a=e.renderer,n=this.state,r=n.errorMsg,o=n.playerName,s=n.phase,i=n.runningGame;return a?a({errorMsg:r,gameComponents:t,gameInstances:this.connection.gameInstances,phase:s,playerName:o,runningGame:i,handleEnterLobby:this._enterLobby,handleExitLobby:this._exitLobby,handleCreateRoom:this._createRoom,handleJoinRoom:this._joinRoom,handleLeaveRoom:this._leaveRoom,handleExitRoom:this._exitRoom,handleRefreshRooms:this._updateConnection,handleStartGame:this._startGame}):E.a.createElement("div",{id:"lobby-view",style:{padding:50}},E.a.createElement("div",{className:this._getPhaseVisibility(Ze.ENTER)},E.a.createElement(Be,{key:o,playerName:o,onEnter:this._enterLobby})),E.a.createElement("div",{className:this._getPhaseVisibility(Ze.LIST)},E.a.createElement("p",null,"Welcome, ",o),E.a.createElement("div",{className:"phase-title",id:"game-creation"},E.a.createElement("span",null,"Create a room:"),E.a.createElement(Ve,{games:t,createGame:this._createRoom})),E.a.createElement("p",{className:"phase-title"},"Join a room:"),E.a.createElement("div",{id:"instances"},E.a.createElement("table",null,E.a.createElement("tbody",null,this.renderRooms(this.connection.gameInstances,o))),E.a.createElement("span",{className:"error-msg"},r,E.a.createElement("br",null))),E.a.createElement("p",{className:"phase-title"},"Rooms that become empty are automatically deleted.")),E.a.createElement("div",{className:this._getPhaseVisibility(Ze.PLAY)},i&&E.a.createElement(i.app,{gameID:i.gameID,playerID:i.playerID,credentials:i.credentials}),E.a.createElement("div",{className:"buttons",id:"game-exit"},E.a.createElement("button",{onClick:this._exitRoom},"Exit game"))),E.a.createElement("div",{className:"buttons",id:"lobby-exit"},E.a.createElement("button",{onClick:this._exitLobby},"Exit lobby")))}}]),t}(E.a.Component);Object(j.a)(Je,"propTypes",{gameComponents:x.a.array.isRequired,lobbyServer:x.a.string,gameServer:x.a.string,debug:x.a.bool,clientFactory:x.a.func}),Object(j.a)(Je,"defaultProps",{debug:!1,clientFactory:Re});var Xe=Je;var Ke=function(){function e(t){var a=this,n=t.enumerate,r=t.seed;Object(f.a)(this,e),Object(j.a)(this,"enumerate",function(e,t,n){return a.enumerateFn(e,t,n).map(function(e){return void 0!==e.payload?e:void 0!==e.move?Q(e.move,e.args,n):void 0!==e.event?$(e.event,e.args,n):void 0})}),this.enumerateFn=n,this.seed=r}return Object(v.a)(e,[{key:"random",value:function(e){var t;if(void 0!==this.seed){var a=null;t=(a=this.prngstate?new ve("",{state:this.prngstate}):new ve(this.seed,{state:!0}))(),this.prngstate=a.state()}else t=Math.random();return e?e.length?e[Math.floor(t*e.length)]:Math.floor(t*e):t}}]),e}(),Qe=function(e){function t(e){var a,n=e.enumerate,r=e.seed,o=e.objectives,s=e.game,i=e.iterations,c=e.playoutDepth;return Object(f.a)(this,t),void 0===o&&(o=function(){return{}}),(a=Object(y.a)(this,Object(b.a)(t).call(this,{enumerate:n,seed:r}))).objectives=o,a.reducer=Me({game:s}),a.iterations=i||1e3,a.playoutDepth=c||50,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"createNode",value:function(e){var t=e.state,a=e.parentAction,n=e.parent,r=e.playerID,o=t.G,s=t.ctx,i=[],c=[];if(void 0!==r)i=this.enumerate(o,s,r),c=this.objectives(o,s,r);else{var l=!0,u=!1,p=void 0;try{for(var h,d=s.actionPlayers[Symbol.iterator]();!(l=(h=d.next()).done);l=!0){var m=h.value;i=i.concat(this.enumerate(o,s,m)),c=c.concat(this.objectives(o,s,m))}}catch(f){u=!0,p=f}finally{try{l||null==d.return||d.return()}finally{if(u)throw p}}}return{state:t,parent:n,parentAction:a,actions:i,objectives:c,children:[],visits:0,value:0}}},{key:"select",value:function(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;var t=null,a=0,n=!0,r=!1,o=void 0;try{for(var s,i=e.children[Symbol.iterator]();!(n=(s=i.next()).done);n=!0){var c=s.value,l=c.visits+Number.EPSILON,u=c.value/l+Math.sqrt(2*Math.log(e.visits)/l);(null==t||u>a)&&(a=u,t=c)}}catch(p){r=!0,o=p}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return this.select(t)}},{key:"expand",value:function(e){var t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;var a=this.random(t.length),n=t[a];e.actions.splice(a,1);var r=this.reducer(e.state,n),o=this.createNode({state:r,parentAction:n,parent:e});return e.children.push(o),o}},{key:"playout",value:function(e){for(var t=this,a=e.state,n=function(e){var n=a,r=n.G,o=n.ctx,s=t.enumerate(r,o,o.actionPlayers[0]),i=t.objectives(r,o),c=Object.keys(i).reduce(function(e,t){var a=i[t];return a.checker(r,o)?e+a.weight:e},0);if(c>0)return{v:{score:c}};if(!s||0==s.length)return{v:void 0};var l=t.random(s.length),u=t.reducer(a,s[l]);a=u},r=0;r<this.playoutDepth&&void 0===a.ctx.gameover;r++){var o=n();if("object"===typeof o)return o.v}return a.ctx.gameover}},{key:"backpropagate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}},{key:"play",value:function(e,t){for(var a=this.createNode({state:e,playerID:t}),n=0;n<this.iterations;n++){var r=this.select(a),o=this.expand(r),s=this.playout(o);this.backpropagate(o,s)}var i=null,c=!0,l=!1,u=void 0;try{for(var p,h=a.children[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var d=p.value;(null==i||d.visits>i.visits)&&(i=d)}}catch(m){l=!0,u=m}finally{try{c||null==h.return||h.return()}finally{if(l)throw u}}return{action:i&&i.parentAction,metadata:a}}}]),t}(Ke);var $e=a(15),et=(a(115),function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).state={root:e.root,preview:null},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({root:e.root})}},{key:"getParents",value:function(e){for(var t=this,a=e,n=[],r=0,o=function(e){return function(){return t.setState({root:e})}},s=function(e){return function(){return t.setState({preview:e})}};a.parent;){var i=a.parent,c=a.parentAction.payload,l=c.type,u=(c.args||[]).join(","),p="".concat(l,"(").concat(u,")");n.push(E.a.createElement("div",{className:"mcts-action-wrapper",key:r++},E.a.createElement(tt,Object($e.a)({onClick:o(i),onMouseOut:function(){return t.setState({preview:null})},onMouseOver:s(i),renderState:this.props.renderState},i)),E.a.createElement("div",{className:"mcts-action"},p),E.a.createElement("div",{className:"arrow-right"}))),a=i}return n.reverse(),n}},{key:"getChildren",value:function(e){var t=this;return e.children.map(function(a,n){var r=a.parentAction.payload,o=r.type,s=(r.args||[]).join(","),i="".concat(o,"(").concat(s,")"),c=function(){return t.setState({root:a})};return 0==a.children.length&&(c=void 0),E.a.createElement("div",{className:"mcts-action-wrapper",key:n},E.a.createElement("div",{className:"mcts-action"},i),E.a.createElement("div",{className:"arrow-right"}),E.a.createElement(tt,Object($e.a)({onClick:c,renderState:t.props.renderState,onMouseOut:function(){return t.setState({preview:null})},onMouseOver:function(){return t.setState({preview:a})}},a,{parentVisits:e.visits})))})}},{key:"getPreview",value:function(){return this.state.preview?E.a.createElement(at,Object($e.a)({},this.state.preview,{renderState:this.props.renderState})):null}},{key:"render",value:function(){var e=this,t=this.state.root;return E.a.createElement("div",{className:"mcts"},E.a.createElement("div",{className:"description"},E.a.createElement("h4",null,"MCTS Visualizer"),E.a.createElement("p",null,"The following diagram explains why the bot made this particular move."),E.a.createElement("p",null,"Interactively browse through the MCTS tree by clicking on various nodes."),E.a.createElement("p",null,"The numbers inside the nodes are the number of visits made by the algorithm."),E.a.createElement("p",null,"Unexpanded nodes are marked black. Read more about MCTS"," ",E.a.createElement("a",{href:"https://jeffbradberry.com/posts/2015/09/intro-to-monte-carlo-tree-search/"},"here"),".")),E.a.createElement("div",{className:"mcts-tree",style:this.props.style},E.a.createElement("section",{className:"parents"},this.getParents(t)),E.a.createElement("section",{className:"root"},E.a.createElement(tt,Object($e.a)({},t,{isRoot:!0,onMouseOut:function(){return e.setState({preview:null})},onMouseOver:function(){return e.setState({preview:t})},renderState:this.props.renderState}))),E.a.createElement("section",{className:"children"},this.getChildren(t)),E.a.createElement("section",{className:"preview"},this.getPreview())))}}]),t}(E.a.Component));Object(j.a)(et,"propTypes",{root:x.a.any.isRequired,renderState:x.a.func,style:x.a.any});var tt=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="mcts-node";return this.props.children.length>0&&(e+=" clickable"),E.a.createElement("div",{className:e,onClick:this.props.onClick,onMouseOut:this.props.onMouseOut,onMouseOver:this.props.onMouseOver},this.props.visits)}}]),t}(E.a.Component);Object(j.a)(tt,"propTypes",{state:x.a.any,visits:x.a.any,onMouseOver:x.a.func,onMouseOut:x.a.func,onClick:x.a.func,children:x.a.any});var at=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this.props,t=e.state,a=e.value,n=e.visits,r=e.parentVisits,o=e.renderState,s="mcts-node-preview";e.isRoot&&(s+=" mcts-root");var i=a/n+Math.sqrt(2*Math.log(r)/n),c=a/n;return i=Math.floor(100*i),c=Math.floor(100*c),r||(i=null),E.a.createElement("div",{className:s},E.a.createElement("div",null,E.a.createElement("li",null,"value ",a),E.a.createElement("li",null,"visits ",n),E.a.createElement("li",null,"ratio ",c),i&&E.a.createElement("li",null,"uct ",i)),o&&o(t))}}]),t}(E.a.Component);Object(j.a)(at,"propTypes",{state:x.a.any,renderState:x.a.func,value:x.a.any,visits:x.a.any,parentVisits:x.a.any,isRoot:x.a.any,children:x.a.any});function nt(e,t){return Object(p.a)({},e,{ctx:rt(e.G,e.ctx,t)})}function rt(e,t,a){var n=[];return a.value&&(n=a.value(e,t)),a.all&&(n=Object(ce.a)(t.playOrder)),a.others&&(n=Object(ce.a)(t.playOrder).filter(function(e){return e!==t.currentPlayer})),Array.isArray(a)&&(n=a),Object(p.a)({},t,{actionPlayers:n,_actionPlayersOnce:a.once,_actionPlayersOthers:a.others})}function ot(e,t){return e[t]+""}var st={DEFAULT:{first:function(e,t){return t.playOrderPos},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},ONCE:{first:function(){return 0},next:function(e,t){if(t.playOrderPos<t.playOrder.length-1)return t.playOrderPos+1}},ANY:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{all:!0}},ANY_ONCE:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{all:!0,once:!0},endPhaseOnceDone:!0},OTHERS:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{others:!0}},OTHERS_ONCE:{first:function(e,t){return t.playOrderPos},next:function(e,t){return t.playOrderPos},actionPlayers:{others:!0,once:!0},endPhaseOnceDone:!0},CUSTOM:function(e){return{playOrder:function(){return e},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},CUSTOM_FROM:function(e){return{playOrder:function(t){return t[e]},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},SKIP:{first:function(e,t){return t.playOrderPos},next:function(e,t){if(!e.allPassed)for(var a=t.playOrderPos,n=0;n<t.playOrder.length;n++)if(a=(a+1)%t.playOrder.length,!e.passOrder.includes(t.playOrder[a]+""))return a}}};function it(e){var t=e.phases,a=e.startingPhase,n=e.movesPerTurn,r=e.endTurnIf,o=e.endGameIf,s=e.onTurnBegin,i=e.onTurnEnd,c=e.onMove,l=e.turnOrder,u=e.endTurn,h=e.endPhase,d=e.endGame,m=e.setActionPlayers,f=e.undoableMoves,v=e.allowedMoves,y=e.redactedMoves,b=e.optimisticUpdate,g=e.game;void 0===h&&t&&(h=!0),void 0===u&&(u=!0),void 0===d&&(d=!1),void 0===m&&(m=!1),void 0===b&&(b=function(){return!0}),void 0===g&&(g={plugins:[]}),t||(t={}),a||(a="default"),r||(r=function(){return!1}),o||(o=function(){}),s||(s=function(e){return e}),i||(i=function(e){return e}),c||(c=function(e){return e}),l||(l=st.DEFAULT),void 0===v&&(v=null),void 0===f&&(f=null);var O=t;for(var k in"default"in O&&A('cannot specify phase with name "default"'),O.default={},O){var E=O[k];void 0===E.endPhaseIf&&(E.endPhaseIf=function(){}),void 0===E.onPhaseBegin&&(E.onPhaseBegin=function(e){return e}),E.onPhaseBegin=je(E.onPhaseBegin,g),void 0===E.onPhaseEnd&&(E.onPhaseEnd=function(e){return e}),E.onPhaseEnd=je(E.onPhaseEnd,g),void 0===E.movesPerTurn&&(E.movesPerTurn=n),void 0===E.endTurnIf&&(E.endTurnIf=r),void 0===E.endGameIf&&(E.endGameIf=o),void 0===E.onTurnBegin&&(E.onTurnBegin=s),E.onTurnBegin=je(E.onTurnBegin,g),void 0===E.onTurnEnd&&(E.onTurnEnd=i),E.onTurnEnd=je(E.onTurnEnd,g),void 0===E.onMove&&(E.onMove=c),E.onMove=je(E.onMove,g),void 0===E.turnOrder&&(E.turnOrder=l),void 0===E.undoableMoves&&(E.undoableMoves=f),void 0===E.allowedMoves&&(E.allowedMoves=v),"function"!==typeof E.allowedMoves&&function(){var e=E.allowedMoves;E.allowedMoves=function(){return e}}()}var C=function(e){var t=e.G,a=e.ctx;return O[a.phase].endPhaseIf(t,a)},x=function(e){var t=e.G,a=e.ctx,n=O[a.phase],r=a.stats.turn.numMoves[a.currentPlayer]||0;return!!(n.movesPerTurn&&r>=n.movesPerTurn)||n.endTurnIf(t,a)},w=function(e,t){var a=t.onPhaseBegin(e.G,e.ctx),n=function(e,t,a){var n=Object(ce.a)(new Array(t.numPlayers)).map(function(e,t){return t+""});void 0!==a.playOrder&&(n=a.playOrder(e,t));var r=a.first(e,t),o=ot(n,r);return t=void 0!==a.actionPlayers?rt(e,t,a.actionPlayers):Object(p.a)({},t,{actionPlayers:[o]}),Object(p.a)({},t,{currentPlayer:o,playOrderPos:r,playOrder:n})}(a,e.ctx,t.turnOrder);a=ke.onPhaseBegin(a,n,g),(n=Ee.onPhaseBegin(n,g)).stats=Object(p.a)({},n.stats,{phase:Object(p.a)({},n.stats.phase,{numMoves:{},allPlayed:!1})});var r=t.allowedMoves(a,n);return Object(p.a)({},e,{G:a,ctx:Object(p.a)({},n,{allowedMoves:r})})},D=function(e,t){var a=t.onTurnBegin(e.G,e.ctx),n=[{G:a,ctx:we.detachAllFromContext(e.ctx)}],r=Object(p.a)({},e.ctx);return r.allowedMoves=t.allowedMoves(a,r),r.stats=Object(p.a)({},r.stats,{turn:Object(p.a)({},r.stats.turn,{numMoves:{},allPlayed:!1})}),Object(p.a)({},e,{G:a,ctx:r,_undo:n,_redo:[]})};function M(e,t,a){var n=(e.ctx.stats[t].numMoves[a]||0)+1,r=Object(p.a)({},e.ctx.stats[t].numMoves,Object(j.a)({},a,n)),o=Object(p.a)({},e.ctx.stats[t],{numMoves:r});Object.keys(r).length==e.ctx.numPlayers&&(o.allPlayed=!0);var s=Object(p.a)({},e.ctx.stats,Object(j.a)({},t,o)),i=Object(p.a)({},e.ctx,{stats:s});return Object(p.a)({},e,{ctx:i})}var I={endTurn:function(e,t){var a=e,n=a.G,r=a.ctx,o=O[r.phase],s=r.stats.turn.numMoves[r.currentPlayer]||0;if(o.movesPerTurn&&s<o.movesPerTurn)return e;n=o.onTurnEnd(n,r);var i=o.endGameIf(n,r);if(void 0!==i)return Object(p.a)({},e,{G:n,ctx:Object(p.a)({},r,{gameover:i})});var c=!1,l=function(e,t,a,n){var r=t.playOrderPos,o=t.currentPlayer,s=t.actionPlayers,i=!1;if(n&&!0!==n)t.playOrder.includes(n.next)?(r=t.playOrder.indexOf(n.next),s=[o=n.next]):A("invalid argument to endTurn: ".concat(n));else{var c=a.next(e,t);void 0===c?i=!0:(r=c,o=ot(t.playOrder,r),void 0===a.actionPlayers&&(s=[o]))}return{endPhase:i,ctx:t=Object(p.a)({},t,{playOrderPos:r,currentPlayer:o,actionPlayers:s})}}(n,r,o.turnOrder,t);c=l.endPhase;var u=(r=l.ctx).turn+1;r=Object(p.a)({},r,{turn:u}),e=Object(p.a)({},e,{G:n,ctx:r});var h=C(e);return h&&(c=!0),c?this.dispatch(e,ee("endPhase",[h],this.playerID)):D(e,o)},endPhase:function(e,t,a){var n=e.G,r=e.ctx,o=O[r.phase];n=o.onPhaseEnd(n,r);var s=o.endGameIf(n,r);if(void 0!==s)return Object(p.a)({},e,{G:n,ctx:Object(p.a)({},r,{gameover:s})});var i=r.phase;t&&!0!==t?t.next in O?r=Object(p.a)({},r,{phase:t.next,prevPhase:i}):A("invalid argument to endPhase: "+t):r=void 0!==o.next?Object(p.a)({},r,{phase:o.next,prevPhase:i}):Object(p.a)({},r,{phase:r.prevPhase,prevPhase:i});var c=(e=w(Object(p.a)({},e,{G:n,ctx:r}),O[r.phase])).ctx.turn;if(a||(a={}),r.phase in a)e=this.dispatch(e,ee("endPhase",[{next:"default"},a],this.playerID));else{a[r.phase]=!0;var l=C(e);l&&(e=this.dispatch(e,ee("endPhase",[l,a],this.playerID)))}var u=x(e);return u&&e.ctx.turn==c&&(e=this.dispatch(e,ee("endTurn",[u],this.playerID))),e},endGame:function(e,t){return void 0===t&&(t=!0),Object(p.a)({},e,{ctx:Object(p.a)({},e.ctx,{gameover:t})})},setActionPlayers:nt},P={};return u&&(P.endTurn=!0),h&&(P.endPhase=!0),d&&(P.endGame=!0),m&&(P.setActionPlayers=!0),function(e){var t=e.ctx,a=e.events,n=e.enabledEvents,r=e.init,o=e.processMove,s=e.optimisticUpdate,i=e.canMakeMove,c=e.canUndoMove,l=e.redactedMoves;t||(t=function(){return{}}),a||(a={}),n||(n={}),r||(r=function(e){return e}),o||(o=function(e){return e}),i||(i=function(){return!0}),c||(c=function(){return!0}),void 0===s&&(s=function(){return!0});var u=function e(t,n){var r=n.payload;if(a.hasOwnProperty(r.type)){var o={playerID:r.playerID,dispatch:e},s={action:n,_stateID:t._stateID},i=[].concat(Object(ce.a)(t.deltalog||[]),[s]),c=[t=Object(p.a)({},t,{deltalog:i})].concat(r.args);return a[r.type].apply(o,c)}return t};return{ctx:t,init:r,canUndoMove:c,redactedMoves:l,eventNames:Object.getOwnPropertyNames(a),enabledEventNames:Object.getOwnPropertyNames(n),processMove:function(e,t){return o(e,t,u)},processGameEvent:function(e,t){return u(e,t)},optimisticUpdate:s,canPlayerCallEvent:function(e,t,a){return t.currentPlayer==a&&t.actionPlayers.includes(a)},canPlayerMakeMove:function(e,t,a){return(t.actionPlayers||[]).includes(a)},canMakeMove:function(e,t,a){return void 0===t.gameover&&i(e,t,a)}}}({ctx:function(e){return{numPlayers:e,turn:0,currentPlayer:"0",actionPlayers:["0"],currentPlayerMoves:0,playOrder:Object(ce.a)(new Array(e)).map(function(e,t){return t+""}),playOrderPos:0,stats:{turn:{numMoves:{}},phase:{numMoves:{}}},allPlayed:!1,phase:a,prevPhase:"default"}},init:function(e){return function(e){if(!(e.ctx.phase in O))return A("invalid startingPhase: "+e.ctx.phase),e;var t=O[e.ctx.phase];return e=w(e,t),e=D(e,t)}(e)},optimisticUpdate:function(e,t,a){return(void 0===t._random||void 0===t._random.prngstate)&&b(e,t,a)},events:I,enabledEvents:P,processMove:function(e,t,a){var n=O[e.ctx.phase];e=M(e,"turn",t.playerID);var r=(e=M(e,"phase",t.playerID)).ctx.actionPlayers,o=!1;if(e.ctx._actionPlayersOnce){var s=t.playerID;0==(r=r.filter(function(e){return e!==s})).length&&n.turnOrder.endPhaseOnceDone&&(o=!0)}e=Object(p.a)({},e,{ctx:Object(p.a)({},e.ctx,{actionPlayers:r})});var i=n.onMove(e.G,e.ctx,t),c=(e=Object(p.a)({},e,{G:i})).ctx.turn,l=n.endGameIf(e.G,e.ctx),u=C(e)||o;(u||void 0!==l)&&(e=a(e,ee("endPhase",[u],t.playerID)),n=O[e.ctx.phase]);var h=x(e);if(e.ctx.turn!=c||!h&&void 0===l||(e=a(e,ee("endTurn",[h],t.playerID))),void 0!==l)return Object(p.a)({},e,{ctx:Object(p.a)({},e.ctx,{gameover:l})});var d=n.allowedMoves(e.G,e.ctx);if(e=Object(p.a)({},e,{ctx:Object(p.a)({},e.ctx,{allowedMoves:d})}),!h){var m=e._undo||[],f=t.type,v=we.detachAllFromContext(e.ctx);e=Object(p.a)({},e,{_undo:[].concat(Object(ce.a)(m),[{G:e.G,ctx:v,moveType:f}]),_redo:[]})}return e},canMakeMove:function(e,t,a){var n=O[t.phase].allowedMoves(e,t);return!n||n.includes(a)},canUndoMove:function(e,t,a){var n=O[t.phase];return!n.undoableMoves||n.undoableMoves.includes(a)},redactedMoves:y})}var ct=function(e){return void 0===e.name&&(e.name="default"),void 0===e.setup&&(e.setup=function(){return{}}),void 0===e.moves&&(e.moves={}),void 0===e.playerView&&(e.playerView=function(e){return e}),void 0===e.plugins&&(e.plugins=[]),e.flow&&void 0!==e.flow.processGameEvent||(e.flow=it(Object(p.a)({game:e},e.flow))),Object(p.a)({},e,{moveNames:Object.getOwnPropertyNames(e.moves),processMove:function(t,a,n){if(e.moves.hasOwnProperty(a.type)){var r=[t,Object(p.a)({},n,{playerID:a.playerID})].concat(a.args);return je(e.moves[a.type],e).apply(void 0,Object(ce.a)(r))}return t}})},lt={STRIP_SECRETS:function(e,t,a){var n=Object(p.a)({},e);return void 0!==n.secret&&delete n.secret,n.players&&(n.players=Object(j.a)({},a,n.players[a])),n}};var ut,pt=ct({name:"tic-tac-toe",setup:function(){return{cells:new Array(9).fill(null)}},moves:{clickCell:function(e,t,a){var n=Object(ce.a)(e.cells);if(null===n[a])return n[a]=t.currentPlayer,Object(p.a)({},e,{cells:n})}},flow:{movesPerTurn:1,endGameIf:function(e,t){return function(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],a=0;a<t.length;a++){var n=t[a],r=e[n[0]],o=r,s=!0,i=!1,c=void 0;try{for(var l,u=n[Symbol.iterator]();!(s=(l=u.next()).done);s=!0)if(e[l.value]!=r){o=null;break}}catch(p){i=!0,c=p}finally{try{s||null==u.return||u.return()}finally{if(i)throw c}}if(null!=o)return!0}return!1}(e.cells)?{winner:t.currentPlayer}:0==e.cells.filter(function(e){return null===e}).length?{draw:!0}:void 0}}}),ht=(a(117),function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){a.isActive(e)&&a.props.moves.clickCell(e)},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"isActive",value:function(e){return this.props.isActive&&null===this.props.G.cells[e]}},{key:"render",value:function(){for(var e=this,t=[],a=0;a<3;a++){for(var n=[],r=function(t){var r=3*a+t;n.push(o.a.createElement("td",{key:r,className:e.isActive(r)?"active":"",onClick:function(){return e.onClick(r)}},e.props.G.cells[r]))},s=0;s<3;s++)r(s);t.push(o.a.createElement("tr",{key:a},n))}var i=null;this.props.isMultiplayer&&!this.props.isConnected&&(i=o.a.createElement("div",null,"Disconnected!"));var c=null;this.props.ctx.gameover&&(c=void 0!==this.props.ctx.gameover.winner?o.a.createElement("div",{id:"winner"},"Winner: ",this.props.ctx.gameover.winner):o.a.createElement("div",{id:"winner"},"Draw!"));var l=null;return this.props.playerID&&(l=o.a.createElement("div",{id:"player"},"Player: ",this.props.playerID)),this.props.isPreview&&(i=l=null),o.a.createElement("div",null,o.a.createElement("table",{id:"board"},o.a.createElement("tbody",null,t)),l,c,i)}}]),t}(o.a.Component)),dt=Re({game:pt,board:ht,ai:function(e){var t=e.bot,a=e.enumerate,n=e.visualize;return t||(t=Qe),{bot:t,enumerate:a,visualize:n}}({enumerate:function(e){for(var t=[],a=0;a<9;a++)null===e.cells[a]&&t.push({move:"clickCell",args:[a]});return t},visualize:(ut=function(e){return o.a.createElement("div",{style:{transform:"scale(0.7)"}},o.a.createElement(ht,Object.assign({},e,{isPreview:!0,moves:{}})))},function(e){return E.a.createElement(et,{root:e,renderState:ut})})})}),mt=function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Singleplayer"),o.a.createElement(dt,{gameID:"single"}))},ft=Re({game:pt,board:ht,debug:!1,multiplayer:{server:"https://jamies-firebase-test-app.firebaseio.com"}}),vt=function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Multiplayer"),o.a.createElement("div",{className:"runner"},o.a.createElement("div",{className:"run"},o.a.createElement(ft,{gameID:"multi",playerID:"0"}),'<App playerID="0"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(ft,{gameID:"multi",playerID:"1"}),'<App playerID="1"/>')))},yt=Re({game:pt,board:ht,debug:!1,multiplayer:{server:"localhost:8000"}}),bt=function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Spectator"),o.a.createElement("div",{className:"runner"},o.a.createElement("div",{className:"run"},o.a.createElement(yt,{gameID:"spectator",playerID:"0"}),'<App playerID="0"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(yt,{gameID:"spectator",playerID:"1"}),'<App playerID="1"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(yt,{gameID:"spectator"}),"Spectator")))},gt=a(45),Ot=a.n(gt),jt=Re({game:pt,board:ht,debug:!1,multiplayer:{server:"localhost:8000"}}),kt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).state={gameID:"gameID",players:{0:{credentials:"credentials"},1:{credentials:"credentials"}}},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)(D.a.mark(function e(){var t,a,n,r,o,s,i,c,l;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t="tic-tac-toe",a=8e3,e.next=4,Ot.a.post("http://localhost:".concat(a,"/games/").concat(t,"/create")).send({numPlayers:2});case 4:n=e.sent,r=n.body.gameID,o=[],s=[0,1],i=0;case 9:if(!(i<s.length)){e.next=18;break}return c=s[i],e.next=13,Ot.a.post("http://localhost:".concat(a,"/games/").concat(t,"/").concat(r,"/join")).send({gameName:t,playerID:c,playerName:c.toString()});case 13:l=e.sent,o.push(l.body.playerCredentials);case 15:i++,e.next=9;break;case 18:this.setState({gameID:r,players:{0:{credentials:o[0]},1:{credentials:o[1]}}});case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onPlayerCredentialsChange",value:function(e,t){this.setState({gameID:this.state.gameID,players:Object(p.a)({},this.state.players,Object(j.a)({},e,{credentials:t}))})}},{key:"render",value:function(){return o.a.createElement(Et,{gameID:this.state.gameID,players:this.state.players,onPlayerCredentialsChange:this.onPlayerCredentialsChange.bind(this)})}}]),t}(o.a.Component),Et=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("h1",null,"Authenticated"),o.a.createElement("p",null,"Change the credentials of a player, and you will notice that the server no longer accepts moves from that client."),o.a.createElement("div",{className:"runner"},o.a.createElement("div",{className:"run"},o.a.createElement(jt,{gameID:this.props.gameID,playerID:"0",credentials:this.props.players[0].credentials}),o.a.createElement("input",{type:"text",value:this.props.players[0].credentials,onChange:function(t){return e.props.onPlayerCredentialsChange("0",t.target.value)}})),o.a.createElement("div",{className:"run"},o.a.createElement(jt,{gameID:this.props.gameID,playerID:"1",credentials:this.props.players[1].credentials}),o.a.createElement("input",{type:"text",value:this.props.players[1].credentials,onChange:function(t){return e.props.onPlayerCredentialsChange("1",t.target.value)}}))))}}]),t}(o.a.Component),Ct={routes:[{path:"/",text:"Singleplayer",component:mt},{path:"/multiplayer",text:"Multiplayer",component:vt},{path:"/authenticated",text:"Authenticated",component:kt},{path:"/spectator",text:"Spectator",component:bt}]},xt=a(17),wt=a.n(xt);function Dt(e){var t=null;return(t=wt.a.Chess?new wt.a.Chess:new wt.a).load_pgn(e),t}var Mt=ct({name:"chess",setup:function(){return{pgn:""}},moves:{move:function(e,t,a){var n=Dt(e.pgn);return"w"==n.turn()&&"1"==t.currentPlayer||"b"==n.turn()&&"0"==t.currentPlayer?Object(p.a)({},e):(n.move(a),{pgn:n.pgn()})}},flow:{movesPerTurn:1,endGameIf:function(e){var t=Dt(e.pgn);if(t.game_over()){if(t.in_draw()||t.in_threefold_repetition()||t.insufficient_material()||t.in_stalemate())return"d";if(t.in_checkmate())return"w"==t.turn()?"b":"w"}}}}),It=E.a.createContext(),Pt=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"getContext",function(){return{genID:function(){return a._nextID++}}}),a._nextID=1,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return E.a.createElement(It.Provider,{value:this.getContext()},E.a.createElement("div",{className:"bgio-ui"},this.props.children))}}]),t}(E.a.Component);Object(j.a)(Pt,"propTypes",{children:x.a.any});var _t=a(13),St=a(28),Lt=a.n(St),Nt=(a(123),function(e){function t(e){var a;Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"animate",function(){requestAnimationFrame(a.animate),Lt.a.update(),a.renderer.render(a.scene,a.camera)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"add",function(e,t){a.childGroup.add(e),void 0!==t&&(a.callbacks_[e.id]=t)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"registerCallback",function(e,t){e&&t&&(a.callbacks_[e.id]=t)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"getContext",function(){return{three:!0,add:a.add,remove:function(e){return a.scene.remove(e)},scene:a.scene,camera:a.camera,regCall:a.registerCallback}}),a.state={isLoading:!1},a.callbacks_={},a.ref_=E.a.createRef(),a.scene=new _t.Scene,a.scene.background=new _t.Color(16777215),a.renderer=new _t.WebGLRenderer({antialias:!0}),a.renderer.shadowMap.enabled=!0,a.renderer.shadowMap.type=_t.PCFSoftShadowMap,a.renderer.setSize(a.props.width,a.props.height),a.camera=new _t.PerspectiveCamera(45,a.props.width/a.props.height,.1,1e3),a.camera.position.z=7,a.camera.position.y=10,a.camera.lookAt(new _t.Vector3),a.scene.add(a.camera);var n=new _t.AmbientLight(16777215,.7);a.scene.add(n);var r=new _t.DirectionalLight(5592405);r.position.y=50,r.shadow.camera.left=-10,r.shadow.camera.bottom=-10,r.shadow.camera.right=10,r.shadow.camera.top=10,r.castShadow=!0,a.scene.add(r);var o=new _t.PlaneBufferGeometry(100,100),s=new _t.MeshLambertMaterial({color:16777215}),i=new _t.Mesh(o,s);i.receiveShadow=!0,i.lookAt(i.up),i.position.y=-.01,a.plane=i,a.scene.add(i);var c=new _t.GridHelper(2e3,2e3);return c.material.opacity=.1,c.material.transparent=!0,a.scene.add(c),a.childGroup=new _t.Group,a.scene.add(a.childGroup),a.loader=E.a.createElement("div",{className:"loader"}),_t.DefaultLoadingManager.onStart=function(){a.setState({isLoading:!0}),a.ref_.current.removeChild(a.renderer.domElement),console.log("Started loading file")},_t.DefaultLoadingManager.onLoad=function(){a.setState({isLoading:!1}),a.ref_.current.appendChild(a.renderer.domElement),console.log("Loading Complete!")},_t.DefaultLoadingManager.onProgress=function(e,t,a){console.log("Loading file: "+e+"\nLoaded "+t+" of "+a+" files.")},_t.DefaultLoadingManager.onError=function(e){console.log("There was an error loading: "+e)},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"setupMouseEvents",value:function(){var e=this,t=[],a=new _t.Vector2;this.raycaster=new _t.Raycaster;var n=function(t,n){void 0===n&&(e.raycaster.setFromCamera(a,e.camera),n=e.raycaster.intersectObjects(e.childGroup.children,!0)),e.props.onMouseEvent&&e.props.onMouseEvent(t,n);var r=n[0];if(r){t.point=r.point;for(var o=e.childGroup.getObjectById(r.object.id);o&&o.parent&&o.id!=e.childGroup.id;){if(o.id in e.callbacks_){e.callbacks_[o.id](t);break}o=o.parent}}},r=this.ref_.current;r.addEventListener("mousemove",function(r){for(var o=r.clientX,s=r.clientY,i=document.getElementById("bgio-canvas"),c=i;c;)c.offsetLeft&&(o-=c.offsetLeft),c.offsetTop&&(s-=c.offsetTop),c=c.offsetParent;for(c=i;c;)c.scrollLeft&&(o+=c.scrollLeft),c.scrollTop&&(s+=c.scrollTop),c=c.parentNode;a.x=o/e.props.width*2-1,a.y=-s/e.props.height*2+1,n(r),e.raycaster.setFromCamera(a,e.camera);var l=e.raycaster.intersectObject(e.plane);if(l.length>0){var u=Object(p.a)({},u,{type:"drag"});t.forEach(function(t){u.point=l[0].point,t.object.id in e.callbacks_&&e.callbacks_[t.object.id](u),t.object.parent.id in e.callbacks_&&e.callbacks_[t.object.parent.id](u)})}}),r.addEventListener("wheel",function(t){n(t),t.defaultPrevented||(t.wheelDelta>0?(e.camera.zoom+=.5,e.camera.updateProjectionMatrix()):e.camera.zoom>.5&&(e.camera.zoom-=.5,e.camera.updateProjectionMatrix()),t.preventDefault())}),r.addEventListener("mousedown",function(r){var o=function(e){if(void 0!==e.which)switch(e.which){case 1:return"leftclick";case 2:return"middleclick";case 3:return"rightclick"}if(void 0!==e.button)switch(e.button){case 0:return"leftclick";case 1:return"middleclick";case 2:return"rightclick"}}(r);e.raycaster.setFromCamera(a,e.camera);var s=e.raycaster.intersectObjects(e.childGroup.children,!0);"leftclick"==o?t=s.filter(function(e){return e.object.userData.draggable&&e.object.userData.responsive}):r=Object(p.a)({},r,{type:o}),n(r,s),t.length>0&&(t=[t[0]],n(Object(p.a)({},r,{type:"dragStart"}),t))}),r.addEventListener("mouseup",function(r){e.raycaster.setFromCamera(a,e.camera);var o=e.raycaster.intersectObjects(e.childGroup.children,!0);if(n(r,o),t.length>0){var s=o.filter(function(e){return e.object.userData.droppable&&e.object.userData.responsive});if(s.length>0){var i=t.map(function(e){return e.object});n(Object(p.a)({},r,{type:"drop",what:i}),s)}n(Object(p.a)({},r,{type:"dragEnd"}),t),t=[]}}),r.addEventListener("click",n),r.addEventListener("contextmenu",function(e){return e.preventDefault()})}},{key:"_initCanvas",value:function(){this.renderer.domElement.id="bgio-canvas",this.ref_.current.appendChild(this.renderer.domElement),this.setupMouseEvents(),this.animate()}},{key:"componentDidMount",value:function(){this._initCanvas()}},{key:"render",value:function(){var e=E.a.Children.map(this.props.children,function(e){return E.a.cloneElement(e,{three:!0})});return E.a.createElement(It.Provider,{value:this.getContext()},E.a.createElement("div",{className:"bgio-ui",ref:this.ref_},this.state.isLoading?this.loader:e))}}]),t}(E.a.Component));Object(j.a)(Nt,"propTypes",{width:x.a.number,height:x.a.number,children:x.a.any,onMouseEvent:x.a.func}),Object(j.a)(Nt,"defaultProps",{width:1024,height:768});var Tt=function(e){return e.three?E.a.createElement(Nt,e,e.children):E.a.createElement(Pt,e,e.children)};Tt.propTypes={three:x.a.bool,children:x.a.any};var Gt=function(e){var t=e.width,a=e.height;return E.a.createElement("svg",{width:t||128,height:a||128,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 128 128"},E.a.createElement("path",{d:"M64,120.37,15.27,92.28V35.91L64,7.82l48.73,28.09V92.28Z",fill:"#373748"}),E.a.createElement("path",{fill:"#000",d:"M64,124,12,94V34L64,4l52,30V94ZM18.33,90.37,64,116.74l45.67-26.37V37.63L64,11.26,18.33,37.63Z"}),E.a.createElement("path",{d:"M81.77,43.17c5.92,0,10.51,1.72,13.57,5.16,3.25,3.44,4.77,8.41,4.77,14.71q0,10.32-5.15,16.06c-3.44,3.82-8.22,5.73-14.53,5.73-5.92,0-10.51-1.72-13.56-5.35-3.25-3.63-4.78-8.6-4.78-15.29s1.72-12,5.16-15.67S75.46,43.17,81.77,43.17Zm-.57,5.16c-4.4,0-7.45,1.15-9.56,3.63s-3,6.31-3,11.66c0,5.73,1,9.74,3,12.42,2.11,2.48,5.16,3.82,9.56,3.82s7.64-1.34,9.74-3.82,3.25-6.5,3.25-11.85c0-5.54-1.15-9.55-3.25-12C88.65,49.48,85.59,48.33,81.2,48.33Z",fill:"#fff"}),E.a.createElement("path",{d:"M39.35,71.45l.19,12.8H33.43L33.62,72l-.19-28.48h6.11l-.19,27.9Z",fill:"#fff"}))};Gt.propTypes={width:x.a.string,height:x.a.string};var At=Gt,Rt=a(30);a(125);var zt=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(){a.props.onClick(a.props.data)}),a.id=e.context.genID(),a.dragComponentRef=E.a.createRef(),a.isOverAccepted=!1,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this,t=["bgio-card"];this.props.className&&t.push(this.props.className);var a={};return this.props.inDeck&&(a={position:"absolute",zIndex:this.props.deckPosition}),E.a.createElement("div",null,E.a.createElement(Rt.b,{id:this.id,type:this.props.dragZone,data:this.props.data},function(e,t,a,n){return function(r){var o=r.isActive,s=r.events;return E.a.createElement("div",Object($e.a)({className:t.join(" "),style:Object(p.a)({},e.style,a,{opacity:o?0:1,pointerEvents:o?"none":"all"}),onClick:n},s),e.isFaceUp?e.front:e.back)}}(this.props,t,a,this.onClick)),E.a.createElement(Rt.a,{for:this.id},function(e,t,a,n){return function(r){var o=r.x,s=r.y,i=r.isOverAccepted,c=r.currentlyHoveredDroppableId,l=Object(ce.a)(t),u=e.back;return n(i),e.isFaceUp&&(u=e.front),null!==c&&(i?l.push("accept"):l.push("reject")),E.a.createElement("div",{className:l.join(" "),ref:a,style:{cursor:"pointer",borderWidth:2,pointerEvents:"none",position:"fixed",zIndex:2e9,boxShadow:"5px 5px 5px #eee",left:o-50,top:s-70}},u)}}(this.props,t,this.dragComponentRef,function(t){return e.isOverAccepted=t})))}}]),t}(E.a.Component);Object(j.a)(zt,"propTypes",{isFaceUp:x.a.bool,front:x.a.node,back:x.a.node,className:x.a.string,dragZone:x.a.string,style:x.a.any,onClick:x.a.func,context:x.a.any.isRequired,inDeck:x.a.bool,data:x.a.any,deckPosition:x.a.number}),Object(j.a)(zt,"defaultProps",{onClick:function(){},isFaceUp:!1,dragZone:"bgio-card",front:E.a.createElement("div",{className:"bgio-card__front"},"Card"),back:E.a.createElement("div",{className:"bgio-card__back"},E.a.createElement(At,{width:"48"}))});var qt=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(zt,Object($e.a)({},e,{context:t}))})},Ft=function(e){function t(e){var a;Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onEvent",function(e){a.props.responsive&&("dragStart"==e.type&&(a.obj.castShadow=!0,new Lt.a.Tween(a.obj.position).to({y:a.originalY+.5},100).easing(Lt.a.Easing.Quadratic.Out).start()),"dragEnd"==e.type&&new Lt.a.Tween(a.obj.position).to({y:a.originalY},100).onComplete(function(){return a.obj.castShadow=!1}).start(),"drag"==e.type&&(a.obj.position.x=e.point.x,a.obj.position.z=e.point.z))}),a.originalY=e.thickness/2-1e-4;var n=new _t.BoxGeometry(e.width,e.thickness,e.height),r={color:7829367};e.image&&(r={map:(new _t.TextureLoader).load(e.image)});var o=new _t.MeshLambertMaterial(r);return a.obj=new _t.Mesh(n,o),a.obj.receiveShadow=!0,a.obj.position.y=a.originalY,a.obj.userData.draggable=e.draggable,a.obj.userData.responsive=e.responsive,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.context.add(this.obj,this.onEvent)}},{key:"componentWillUnmount",value:function(){this.props.context.remove(this.obj)}},{key:"render",value:function(){return this.obj.position.x=this.props.x+this.props.splayX,this.obj.position.z=this.props.z+this.props.splayZ,this.obj.position.y=this.originalY+this.props.splayY,null}}]),t}(E.a.Component);Object(j.a)(Ft,"propTypes",{context:x.a.any.isRequired,image:x.a.string,width:x.a.number,height:x.a.number,thickness:x.a.number,responsive:x.a.bool,draggable:x.a.bool,x:x.a.number,z:x.a.number,splayX:x.a.number,splayY:x.a.number,splayZ:x.a.number}),Object(j.a)(Ft,"defaultProps",{responsive:!0,draggable:!0,splayX:0,splayY:0,splayZ:0,x:0,z:0,width:1,height:1.5,thickness:.01});var Ut=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(Ft,Object($e.a)({},e,{context:t}))})},Bt=function(e){return E.a.createElement(It.Consumer,null,function(t){return t.three?E.a.createElement(Ut,Object($e.a)({},e,{context:t})):E.a.createElement(qt,Object($e.a)({},e,{context:t}))})};Bt.propTypes={children:x.a.any};a(127);var Ht=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(){var e=E.a.Children.toArray(a.props.children),t=null;e.length>0&&(t=e[e.length-1].props,a.props.onClick(t.data))}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onDrop",function(e){var t=!1;E.a.Children.forEach(a.props.children,function(a){void 0!==e&&a.props.data===e&&(t=!0)}),t||a.props.onDrop(e)}),a.id=e.context.genID(),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this,t=0,a=E.a.Children.map(this.props.children,function(a){return E.a.cloneElement(a,{dragZone:e.props.dragZone,inDeck:!0,deckPosition:t++})});return E.a.createElement("div",{onClick:this.onClick},E.a.createElement(Rt.c,{accepts:this.props.dragZone,onDrop:this.onDrop},function(t){var n=t.events;return E.a.createElement("div",Object($e.a)({},n,{className:e.props.className,style:{background:"#eee",marginRight:20,padding:e.props.padding,position:"relative",width:"100px",height:"140px",display:"block",float:"left"}}),a)}))}}]),t}(E.a.Component);Object(j.a)(Ht,"propTypes",{context:x.a.any,children:x.a.any,onClick:x.a.func,onDrop:x.a.func,splayWidth:x.a.number,dragZone:x.a.string,padding:x.a.number,className:x.a.string}),Object(j.a)(Ht,"defaultProps",{padding:10,splayWidth:3,dragZone:"bgio-card",onDrop:function(){},onClick:function(){}});var Wt=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(Ht,Object($e.a)({},e,{context:t}))})},Yt=function(e){function t(e){var a;Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"state",{isHighlighted:!1}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onEvent",function(e){"drop"==e.type&&(e.what[0].position.x=-2,e.what[0].position.z=0,e.what[0].position.y+=.4)}),a.originalY=e.thickness/2-1e-4;var n=new _t.BoxGeometry(e.width,e.thickness,e.height),r=new _t.MeshLambertMaterial({color:13421772});return a.obj=new _t.Mesh(n,r),a.obj.userData.droppable=!0,a.obj.userData.responsive=!0,a.obj.position.y=a.originalY,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){this.props.context.add(this.obj,this.onEvent)}},{key:"componentWillUnmount",value:function(){this.props.context.remove(this.obj)}},{key:"render",value:function(){this.obj.position.x=-2;for(var e=[],t=0;t<20;t++)e.push(E.a.createElement(Ut,{key:t,responsive:!1,x:-2,splayY:.02*t}));return e}}]),t}(E.a.Component);Object(j.a)(Yt,"propTypes",{context:x.a.any.isRequired,width:x.a.number,height:x.a.number,thickness:x.a.number}),Object(j.a)(Yt,"defaultProps",{width:1,height:1.5,thickness:.01});var Vt=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(Yt,Object($e.a)({},e,{context:t}))})},Zt=function(e){return E.a.createElement(It.Consumer,null,function(t){return t.three?E.a.createElement(Vt,Object($e.a)({},e,{context:t})):E.a.createElement(Wt,Object($e.a)({},e,{context:t}))})};Zt.propTypes={children:x.a.any};var Jt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_svgRef",E.a.createRef()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(e){a.props.onClick&&a.props.onClick(e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOver",function(e){a.props.onMouseOver&&a.props.onMouseOver(e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOut",function(e){a.props.onMouseOut&&a.props.onMouseOut(e)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"_getCellColor",value:function(e,t){var a="".concat(e,",").concat(t),n="white";return a in this.props.colorMap&&(n=this.props.colorMap[a]),n}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var e=[],t=0;t<this.props.cols;t++)for(var a=0;a<this.props.rows;a++)e.push(E.a.createElement(Xt,{key:this.props.cols*a+t,style:{fill:this._getCellColor(t,a)},x:t,y:a,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}));return e}},{key:"render",value:function(){var e=this,t=E.a.Children.map(this.props.children,function(t){return E.a.cloneElement(t,{template:Xt,onClick:e.onClick,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut,svgRef:e._svgRef})});return E.a.createElement("svg",{ref:this._svgRef,viewBox:"0 0 "+this.props.cols+" "+this.props.rows,style:this.props.style},E.a.createElement("g",null,this._getGrid()),t)}}]),t}(E.a.Component);Object(j.a)(Jt,"propTypes",{rows:x.a.number.isRequired,cols:x.a.number.isRequired,outline:x.a.bool,style:x.a.object,colorMap:x.a.object,cellSize:x.a.number,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,children:x.a.oneOfType([x.a.arrayOf(x.a.element),x.a.element])}),Object(j.a)(Jt,"defaultProps",{colorMap:{},outline:!0,cellSize:1});var Xt=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_gRef",E.a.createRef()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(e){a.props.onClick(a.getCoords(),e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOver",function(e){a.props.onMouseOver(a.getCoords(),e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOut",function(e){a.props.onMouseOut(a.getCoords(),e)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"getCoords",value:function(){return{x:this.props.x,y:this.props.y}}},{key:"componentDidMount",value:function(){var e=this._gRef.current,t=!0,a=!1,n=void 0;try{for(var r,o=this.props.eventListeners[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e.addEventListener(s.name,s.callback)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"componentWillUnmount",value:function(){var e=this._gRef.current,t=!0,a=!1,n=void 0;try{for(var r,o=this.props.eventListeners[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e.removeEventListener(s.name,s.callback)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"render",value:function(){var e=this.props.x*this.props.size,t=this.props.y*this.props.size,a=E.a.createElement("rect",{style:this.props.style,width:this.props.size,height:this.props.size,x:0,y:0});return this.props.children&&(a=this.props.children),E.a.createElement("g",{ref:this._gRef,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate(".concat(e,", ").concat(t,")")},a)}}]),t}(E.a.Component);Object(j.a)(Xt,"propTypes",{x:x.a.number.isRequired,y:x.a.number.isRequired,size:x.a.number,style:x.a.any,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,eventListeners:x.a.array,children:x.a.element}),Object(j.a)(Xt,"defaultProps",{size:1,x:0,y:0,style:{fill:"#fff"},eventListeners:[]});var Kt=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(Qt,Object($e.a)({},e,{context:t}))})},Qt=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).boardGroup=new _t.Group,a.tokenGroup=new _t.Group,a.boardGroup.add(a.tokenGroup),a.boardGroup.translateX(-(a.props.padding+a.props.cellSize)*(a.props.cols-1)/2),a.boardGroup.translateZ(-(a.props.padding+a.props.cellSize)*(a.props.rows-1)/2),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"_getCellColor",value:function(e,t){var a="".concat(e,",").concat(t),n="#777777";return a in this.props.colorMap&&(n=this.props.colorMap[a]),n}},{key:"componentWillUnmount",value:function(){this.context.remove(this.boardGroup)}},{key:"render",value:function(){var e=this;this.context=this.props.context,this.context.add(this.boardGroup),this.boardGroup.remove(this.squareGroup),this.squareGroup=new _t.Group,this.boardGroup.add(this.squareGroup);for(var t=function(t){for(var a=function(a){var n={x:t,y:a,size:e.props.cellSize,color:e._getCellColor(t,a),padding:e.props.padding,thickness:e.props.thickness},r=new $t(n);e.squareGroup.add(r);e.context.regCall(r,function(n){"click"==n.type?e.props.onClick&&e.props.onClick({x:t,y:a}):"mouseOver"==n.type?e.props.onMouseOver&&e.props.onMouseOver({x:t,y:a}):"mouseOut"==n.type&&e.props.onMouseOut&&e.props.onMouseOut({x:t,y:a})})},n=0;n<e.props.rows;n++)a(n)},a=0;a<this.props.cols;a++)t(a);var n=E.a.Children.map(this.props.children,function(t){return E.a.cloneElement(t,{three:!0,boardSize:e.props.cellSize,parent:e.tokenGroup,padding:e.props.padding,lift:e.props.thickness})});return n||null}}]),t}(E.a.Component);Object(j.a)(Qt,"propTypes",{rows:x.a.number.isRequired,cols:x.a.number.isRequired,cellSize:x.a.number,thickness:x.a.number,padding:x.a.number,colorMap:x.a.object,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,context:x.a.any,children:x.a.oneOfType([x.a.arrayOf(x.a.element),x.a.element])}),Object(j.a)(Qt,"defaultProps",{colorMap:{},cellSize:1,padding:.1,thickness:.1});var $t=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this))).userData=Object(p.a)({responsive:!0,draggable:!1},e),e=a.userData,a.geometry=new _t.BoxBufferGeometry(e.size,e.thickness,e.size),a.material=new _t.MeshLambertMaterial({color:e.color}),a.receiveShadow=!0,a.translateX(a.userData.x*(e.size+e.padding)),a.translateZ(a.userData.y*(e.size+e.padding)),a.translateY(a.userData.thickness/2),a}return Object(g.a)(t,e),t}(_t.Mesh),ea=function(e){return e.three?E.a.createElement(Kt,e,e.children):E.a.createElement(Jt,e,e.children)};ea.propTypes={three:x.a.bool,children:x.a.any};x.a.bool,x.a.any;var ta=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r))),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_svgRef",E.a.createRef()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(e){a.props.onClick&&a.props.onClick(e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOver",function(e){a.props.onMouseOver&&a.props.onMouseOver(e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOut",function(e){a.props.onMouseOut&&a.props.onMouseOut(e)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"_getCellColor",value:function(e,t,a){var n="".concat(e,",").concat(t,",").concat(a),r="white";return n in this.props.colorMap&&(r=this.props.colorMap[n]),r}},{key:"_getGrid",value:function(){if(!this.props.outline)return null;for(var e=[],t=this.props.levels,a=-t;a<=t;a++)for(var n=-t;n<=t;n++){var r=-a-n;Math.abs(r)>t||e.push(E.a.createElement(aa,{key:"".concat(a,":").concat(n,":").concat(r),style:{fill:this._getCellColor(a,n,r)},x:a,y:n,z:r,size:this.props.cellSize,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut}))}return e}},{key:"render",value:function(){var e=this,t=E.a.Children.map(this.props.children,function(t){return E.a.cloneElement(t,{template:aa,onClick:e.onClick,onMouseOver:e.onMouseOver,onMouseOut:e.onMouseOut,svgRef:e._svgRef})}),a=this.props.cellSize*this.props.levels*2;return E.a.createElement("svg",{ref:this._svgRef,viewBox:-a+" "+-a+" "+2*a+" "+2*a,style:this.props.style},E.a.createElement("g",null,this._getGrid()),t)}}]),t}(E.a.Component);Object(j.a)(ta,"propTypes",{levels:x.a.number.isRequired,outline:x.a.bool,style:x.a.object,colorMap:x.a.object,cellSize:x.a.number,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,children:x.a.oneOfType([x.a.arrayOf(x.a.element),x.a.element])}),Object(j.a)(ta,"defaultProps",{levels:5,colorMap:{},outline:!0,cellSize:1});var aa=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_gRef",E.a.createRef()),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onClick",function(e){a.props.onClick(a.getCoords(),e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOver",function(e){a.props.onMouseOver(a.getCoords(),e)}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"onMouseOut",function(e){a.props.onMouseOut(a.getCoords(),e)}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this._gRef.current,t=!0,a=!1,n=void 0;try{for(var r,o=this.props.eventListeners[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e.addEventListener(s.name,s.callback)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"componentWillUnmount",value:function(){var e=this._gRef.current,t=!0,a=!1,n=void 0;try{for(var r,o=this.props.eventListeners[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;e.removeEventListener(s.name,s.callback)}}catch(i){a=!0,n=i}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}}},{key:"getCoords",value:function(){return{x:this.props.x,y:this.props.y,z:this.props.z}}},{key:"render",value:function(){var e=this.center.x,t=this.center.y,a=E.a.createElement("polygon",{style:this.props.style,points:this.points,stroke:"#aaa",strokeWidth:.01});return this.props.children&&(a=this.props.children),E.a.createElement("g",{ref:this._gRef,onClick:this.onClick,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,transform:"translate(".concat(e,", ").concat(t,")")},a)}},{key:"width",get:function(){return 2*this.props.size}},{key:"height",get:function(){return(Math.sqrt(3)/2*this.width).toFixed(3)}},{key:"center",get:function(){var e=this.props.x,t=this.props.z;return{x:3*this.props.size*e/2,y:this.props.size*Math.sqrt(3)*(t+e/2)}}},{key:"points",get:function(){var e=this.props.size,t=this.height,a=-e/2,n=+e/2,r=+e,o=n,s=a,i=t/2,c=i,l=-t/2,u=l;return["".concat(-e,",").concat(0),"".concat(a,",").concat(i),"".concat(n,",").concat(c),"".concat(r,",").concat(0),"".concat(o,",").concat(l),"".concat(s,",").concat(u)].join(" ")}}]),t}(E.a.Component);Object(j.a)(aa,"propTypes",{x:x.a.number,y:x.a.number,z:x.a.number,size:x.a.number,style:x.a.any,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,eventListeners:x.a.array,children:x.a.element}),Object(j.a)(aa,"defaultProps",{size:1,x:0,y:0,z:0,style:{fill:"#fff"},eventListeners:[]});E.a.Component,E.a.Component;x.a.bool,x.a.any;x.a.bool,x.a.any;a(46);var na=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this,e)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_startDrag",function(e){a.props.draggable&&a.props.shouldDrag(a.getCoords())&&(e.preventDefault(),e=e.touches?e.touches[0]:e,a.setState(Object(p.a)({},a.state,{dragged:{x:e.pageX,y:e.pageY}})),a._addOrRemoveDragEventListeners(!0))}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_drag",function(e){if(a.state.dragged){e.preventDefault(),e=e.touches?e.touches[0]:e;var t=a.props.svgRef.current.getScreenCTM().inverse(),n=e.pageX-a.state.dragged.x,r=e.pageY-a.state.dragged.y,o=t.a*n+t.b*r,s=t.c*n+t.d*r,i=a.state.x+o,c=a.state.y+s;a.props.onDrag&&a.props.onDrag({x:i,y:c,originalX:a.props.x,originalY:a.props.y}),a.setState(Object(p.a)({},a.state,{x:i,y:c,dragged:{x:e.pageX,y:e.pageY}}))}}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_endDrag",function(e){a.state.dragged&&(e.preventDefault(),Math.sqrt(Math.pow(a.state.x-a.props.x,2)+Math.pow(a.state.y-a.props.y,2))>.2?a.props.onDrop({x:a.state.x,y:a.state.y,originalX:a.props.x,originalY:a.props.y}):a.props.onClick({x:a.state.x,y:a.state.y}),a.setState(Object(p.a)({},a.state,{x:a.props.x,y:a.props.y,dragged:null})),a._addOrRemoveDragEventListeners(!1))}),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_onClick",function(e){a.props.draggable&&a.props.shouldDrag(a.getCoords())||a.props.onClick(e)}),a.state=Object(p.a)({},a.getCoords(),{dragged:null,usingTouch:!1}),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentWillUnmount",value:function(){this.state.dragged&&this._addOrRemoveDragEventListeners(!1)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.getCoords(),a=this.getCoords(e);t.x==a.x&&t.y==a.y||(this.setState(Object(p.a)({},this.state,{originTime:Date.now(),originX:this.state.x,originY:this.state.y,originZ:this.state.z})),requestAnimationFrame(this._animate(Date.now())))}},{key:"_addOrRemoveDragEventListeners",value:function(e){var t=this.props.svgRef.current;if(t){var a=t.addEventListener;e||(a=t.removeEventListener),a("touchmove",this._drag,{passive:!1}),a("mousemove",this._drag,{passive:!1}),a("mouseup",this._endDrag,{passive:!1}),a("mouseleave",this._endDrag,{passive:!1}),a("touchcancel",this._endDrag,{passive:!1}),a("touchleave",this._endDrag,{passive:!1}),a("touchend",this._endDrag,{passive:!1})}}},{key:"_animate",value:function(e){var t=this;return function(){var a=e-t.state.originTime,n=t.getCoords();if(a<t.props.animationDuration&&t.props.animate){var r=t._easeInOutCubic(a,0,1,t.props.animationDuration);t.setState(Object(p.a)({},t.state,{x:(n.x-t.state.originX)*r+t.state.originX,y:(n.y-t.state.originY)*r+t.state.originY,z:(n.z-t.state.originZ)*r+t.state.originZ})),requestAnimationFrame(t._animate(Date.now()))}else t.setState(Object(p.a)({},t.state,{x:n.x,y:n.y,z:n.z}))}.bind(this)}},{key:"getCoords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{x:e.x,y:e.y,z:e.z}}},{key:"_easeInOutCubic",value:function(e,t,a,n){return(e/=n/2)<1?a/2*e*e*e+t:a/2*((e-=2)*e*e+2)+t}},{key:"_eventListeners",value:function(){return[{name:"mousedown",callback:this._startDrag},{name:"touchstart",callback:this._startDrag}]}},{key:"render",value:function(){var e=this.props.template;return E.a.createElement(e,{x:this.state.x,y:this.state.y,z:this.state.z,style:this.props.style,onClick:this._onClick,onMouseOver:this.props.onMouseOver,onMouseOut:this.props.onMouseOut,eventListeners:this._eventListeners()},this.props.children)}}]),t}(E.a.Component);Object(j.a)(na,"propTypes",{x:x.a.number,y:x.a.number,z:x.a.number,template:x.a.any,style:x.a.any,animate:x.a.bool,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,children:x.a.element,animationDuration:x.a.number,draggable:x.a.bool,shouldDrag:x.a.func,onDrag:x.a.func,onDrop:x.a.func,svgRef:x.a.object}),Object(j.a)(na,"defaultProps",{animationDuration:750,template:Xt});var ra=function(e){return E.a.createElement(It.Consumer,null,function(t){return E.a.createElement(oa,Object($e.a)({},e,{context:t}))})},oa=function(e){function t(e){var a;return Object(f.a)(this,t),a=Object(y.a)(this,Object(b.a)(t).call(this)),Object(j.a)(Object(O.a)(Object(O.a)(a)),"_attachMesh",function(e){var t=a.size,n=new _t.Vector3,r=new _t.Vector3,o=(new _t.Box3).setFromObject(e);o.getSize(n),o.getCenter(r);var s=n.z<n.x?n.x:n.z;s=t/s,e.scale.set(s,s,s),a.props.boardSize&&a.props.lift&&a.props.padding?(e.position.x=a.props.x*(a.props.boardSize+a.props.padding),e.position.z=a.props.y*(a.props.boardSize+a.props.padding),e.position.y=-o.min.y+a.props.lift):(e.position.x=a.props.x,e.position.z=a.props.y,e.position.y=-o.min.y),a.parent.add(e);a.props.context.regCall(e,function(e){"click"==e.type?a.props.onClick({x:a.props.x,y:a.props.y}):"mouseOver"==e.type?a.props.onMouseOver({x:a.props.x,y:a.props.y}):"mouseOut"==e.type&&a.props.onMouseOut({x:a.props.x,y:a.props.y})})}),e.size?a.size=e.size:a.size=e.boardSize,e.parent?a.parent=e.parent:a.parent=e.context,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentWillUnmount",value:function(){this.parent.remove(this.prevMesh)}},{key:"render",value:function(){var e=this.props.mesh;return this.prevMesh&&this.prevMesh===e?null:(e?e.isObject3D?this._attachMesh(e):console.error("Your input to tokens should be an three js 3d object"):(e=new _t.Mesh(new _t.BoxBufferGeometry(1,.3,1),new _t.MeshLambertMaterial({color:"#eeeeee"})),this._attachMesh(e)),this.parent.remove(this.prevMesh),this.prevMesh=e,null)}}]),t}(E.a.Component);Object(j.a)(oa,"propTypes",{x:x.a.number,y:x.a.number,z:x.a.number,mesh:x.a.any,padding:x.a.number,size:x.a.number,lift:x.a.number,boardSize:x.a.number,parent:x.a.instanceOf(_t.Object3D),context:x.a.object,animate:x.a.bool,onClick:x.a.func,onMouseOver:x.a.func,onMouseOut:x.a.func,children:x.a.element,animationDuration:x.a.number}),Object(j.a)(oa,"defaultProps",{animationDuration:750,size:1,padding:.1,lift:.1});var sa=function(e){return e.three?E.a.createElement(ra,e,e.children):E.a.createElement(na,e,e.children)};sa.propTypes={three:x.a.bool,children:x.a.any};var ia=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){var t=e.x,n=e.y;a.props.onClick({square:la(t,n,a.props.rows)})},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){for(var e=this,t=o.a.Children.map(this.props.children,function(t){var a=ca(t.props.square,e.props.rows),n=a.x,r=a.y;return o.a.cloneElement(t,{x:n,y:r})}),a={},n=0;n<this.props.cols;n++)for(var r=0;r<this.props.rows;r++){var s="".concat(n,",").concat(r),i=this.props.secondaryColor;(n+r)%2==0&&(i=this.props.primaryColor),a[s]=i}for(var c in this.props.highlightedSquares){var l=ca(c,this.props.rows),u=l.x,p=l.y;a["".concat(u,",").concat(p)]=this.props.highlightedSquares[c]}return o.a.createElement(ea,{rows:this.props.rows,cols:this.props.cols,style:this.props.style,onClick:this.onClick,colorMap:a},t)}}]),t}(o.a.Component);function ca(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,a=/([A-Za-z])(\d+)/g.exec(e);if(null==a)throw"Invalid square provided: "+e;return{x:a[1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),y:t-parseInt(a[2])}}function la(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;return String.fromCharCode(e+"a".charCodeAt(0))+(a-t)}ia.defaultProps={rows:8,cols:8,onClick:function(){},primaryColor:"#d18b47",secondaryColor:"#ffce9e",highlightedSquares:{},style:{}};var ua=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="b"==this.props.color?"#000000":"#FFFFFF",t="b"==this.props.color?"#FFFFFF":"#000000";return o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{opacity:1,fill:"none",fillRule:"evenodd",fillOpacity:1,stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("g",{style:{fill:e,stroke:"#000000",strokeLinecap:"butt"}},o.a.createElement("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z"}),o.a.createElement("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),o.a.createElement("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})),o.a.createElement("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:t,strokeLinejoin:"miter"}})))}}]),t}(o.a.Component),pa=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="b"==this.props.color?"#000000":"#FFFFFF",t="b"==this.props.color?"#FFFFFF":"#000000",a=null;return"b"==this.props.color&&(a=o.a.createElement("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85",style:{fill:"none",stroke:"#ffffff"}})),o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{fill:"none",fillOpacity:1,fillRule:"evenodd",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:e,stroke:t,strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z ",style:{fill:e,stroke:"#000000"}}),o.a.createElement("path",{d:"M 11.5,30 C 17,27 27,27 32.5,30",style:{fill:"none",stroke:t}}),o.a.createElement("path",{d:"M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:t}}),o.a.createElement("path",{d:"M 11.5,37 C 17,34 27,34 32.5,37",style:{fill:"none",stroke:t}}),a))}}]),t}(o.a.Component),ha=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="b"==this.props.color?"#000000":"#FFFFFF",t="b"==this.props.color?"#FFFFFF":"#000000",a=null;return"b"==this.props.color&&(a=o.a.createElement("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})),o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{opacity:1,fill:"none",fillOpacity:1,fillRule:"evenodd",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:e,stroke:"#000000"}}),o.a.createElement("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:e,stroke:"#000000"}}),o.a.createElement("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:t,stroke:t}}),o.a.createElement("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:t,stroke:t}}),a))}}]),t}(o.a.Component),da=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="b"==this.props.color?"#000000":"#FFFFFF";return o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("path",{d:"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z ",style:{opacity:1,fill:e,fillOpacity:1,fillRule:"nonzero",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}}))}}]),t}(o.a.Component),ma=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e="b"==this.props.color?"#000000":"#FFFFFF",t="b"==this.props.color?"#FFFFFF":"#000000";return o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{opacity:1,fill:e,fillOpacity:1,fillRule:"evenodd",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("path",{d:"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z",transform:"translate(-1,-1)"}),o.a.createElement("path",{d:"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z",transform:"translate(15.5,-5.5)"}),o.a.createElement("path",{d:"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z",transform:"translate(32,-1)"}),o.a.createElement("path",{d:"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z",transform:"translate(7,-4.5)"}),o.a.createElement("path",{d:"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z",transform:"translate(24,-4)"}),o.a.createElement("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none",stroke:t}}),o.a.createElement("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none",stroke:t}})))}}]),t}(o.a.Component),fa=function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return"b"==this.props.color?o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{opacity:1,fill:"#000000",fillOpacity:1,fillRule:"evenodd",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:1,strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:1,strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:1,strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:1,strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:1,strokeLinejoin:"miter"}}))):o.a.createElement("g",{transform:"scale(.022222,.022222)"},o.a.createElement("g",{style:{opacity:1,fill:"#ffffff",fillOpacity:1,fillRule:"evenodd",stroke:"#000000",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeOpacity:1}},o.a.createElement("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),o.a.createElement("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),o.a.createElement("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),o.a.createElement("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),o.a.createElement("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})))}}]),t}(o.a.Component),va=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).state={selected:"",highlighted:"",dragged:""},a.click=function(e){var t=e.square;a.props.isActive&&(!a.state.selected&&a._isSelectable(t)?a.setState(Object(p.a)({},a.state,{selected:t,highlighted:t})):a.state.selected&&a._tryMove(a.state.selected,t))},a._shouldDrag=function(e){var t=la(e.x,e.y);if(a.props.isActive&&a._isSelectable(t))return a.setState(Object(p.a)({},a.state,{dragged:a._getInitialCell(t)})),!0},a._onDrag=function(e){var t=e.x,n=e.y,r=e.originalX,o=e.originalY;Math.sqrt(Math.pow(t-r,2)+Math.pow(n-o,2))>.2?a.setState(Object(p.a)({},a.state,{selected:a._getSquare(r,o),highlighted:a._getSquare(t,n)})):a.setState(Object(p.a)({},a.state,{selected:"",highlighted:""}))},a._onDrop=function(e){var t=e.x,n=e.y;a.state.selected&&(a.setState(Object(p.a)({},a.state,{dragged:""})),a._tryMove(a.state.selected,a._getSquare(t,n)))},a.chess=new wt.a,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){void 0!==this.props.G.pgn&&this.chess.load_pgn(this.props.G.pgn);var e=null;return this.props.isMultiplayer&&!this.props.isConnected&&(e=o.a.createElement("p",null,"Disconnected!")),o.a.createElement("div",null,o.a.createElement(ia,{highlightedSquares:this._getHighlightedSquares(),style:{width:"400px"},onClick:this.click},this._getPieces()),this._getStatus(),e)}},{key:"_getHighlightedSquares",value:function(){var e={},t=!0,a=!1,n=void 0;try{for(var r,o=this._getMoves()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){e[r.value.to]="palegreen"}}catch(s){a=!0,n=s}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return this.state.highlighted&&(e[this.state.highlighted]="green"),e}},{key:"_getSquare",value:function(e,t){return la(this._getInRange(e),this._getInRange(t))}},{key:"_getInRange",value:function(e){return Math.max(Math.min(Math.round(e),7),0)}},{key:"_getPieces",value:function(){for(var e=[],t=[],a=1;a<=8;a++)for(var n=0;n<8;n++){var r="abcdefgh"[n]+a,s=this.chess.get(r);if(s){var i=o.a.createElement(sa,{draggable:!0,shouldDrag:this._shouldDrag,onDrag:this._onDrag,onDrop:this._onDrop,square:r,animate:!0,key:this._getInitialCell(r)},this._getPieceByTypeAndColor(s.type,s.color));r===this.state.dragged?t.push(i):e.push(i)}}return e.concat(t)}},{key:"_getPieceByTypeAndColor",value:function(e,t){switch(e){case"b":return o.a.createElement(ua,{color:t});case"k":return o.a.createElement(pa,{color:t});case"n":return o.a.createElement(ha,{color:t});case"p":return o.a.createElement(da,{color:t});case"q":return o.a.createElement(ma,{color:t});case"r":return o.a.createElement(fa,{color:t})}}},{key:"_getStatus",value:function(){var e=null;if(this.chess.in_check()&&(e="CHECK"),this.props.ctx.winner)switch(this.props.ctx.winner){case"b":e="Black won!";break;case"w":e="White won!";break;case"d":e="Draw!"}if(e)return o.a.createElement("p",null,o.a.createElement("strong",null,e))}},{key:"_getInitialCell",value:function(e){for(var t=this.chess.history({verbose:!0}),a=e,n=t.length-1;n>=0;n--){var r=t[n];a==r.to&&(a=r.from)}return a}},{key:"_isSelectable",value:function(e){var t=this.chess.get(e);return t&&t.color===this._getCurrentPlayer()&&this.chess.moves({square:e}).length>0}},{key:"_getCurrentPlayer",value:function(){return 0==this.props.ctx.currentPlayer?"w":"b"}},{key:"_getMoves",value:function(){return this.state.selected?this.chess.moves({verbose:!0,square:this.state.selected}):[]}},{key:"_tryMove",value:function(e,t){var a=this._getMoves().find(function(a){return a.from==e&&a.to==t});a&&this.props.moves.move(a.san),this.setState(Object(p.a)({},this.state,{selected:"",highlighted:""}))}}]),t}(o.a.Component),ya=Re({game:Mt,board:va}),ba=function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(ya,{gameID:"single"}))},ga=Re({game:Mt,board:va,multiplayer:{server:"localhost:8000"},debug:!1}),Oa={routes:[{path:"/chess/singleplayer",text:"Singleplayer",component:ba},{path:"/chess/multiplayer",text:"Multiplayer",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(ga,{gameID:"multi",playerID:"0"}),o.a.createElement(ga,{gameID:"multi",playerID:"1"}))}}]},ja=(a(129),Re({game:ct({setup:function(){return{deck:5,hand:0}},moves:{takeCard:function(e){return Object(p.a)({},e,{deck:e.deck-1,hand:e.hand+1})},playCard:function(e){return Object(p.a)({},e,{deck:e.deck+1,hand:e.hand-1})}},flow:{startingPhase:"take",phases:{take:{endPhaseIf:function(e){return e.deck<=0},allowedMoves:["takeCard"],next:"play"},play:{allowedMoves:["playCard"],endPhaseIf:function(e){return e.hand<=0},next:"take"}}}}),numPlayers:1,board:function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).takeCard=function(){"take"==a.props.ctx.phase&&(a.props.moves.takeCard(),a.props.events.endTurn())},a.playCard=function(){"play"==a.props.ctx.phase&&(a.props.moves.playCard(),a.props.events.endTurn())},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"phases"},o.a.createElement("li",{style:{background:"#aaa"}},this.props.ctx.phase),o.a.createElement("li",null,"Deck: ",this.props.G.deck),o.a.createElement("li",null,"Hand: ",this.props.G.hand),o.a.createElement("li",null,o.a.createElement("button",{id:"take",onClick:this.takeCard},"Take Card")),o.a.createElement("li",null,o.a.createElement("button",{id:"play",onClick:this.playCard},"Play Card")))}}]),t}(o.a.Component)})),ka=(a(131),{routes:[{path:"/phases",text:"Phases",component:ja},{path:"/diagram",text:"Diagram",component:Re({game:ct({moves:{},flow:{startingPhase:"A",phases:{A:{next:"B"},B:{next:"C"},C:{next:"A"}}}}),numPlayers:3,debug:!1,board:function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){for(var e=this,t=[o.a.createElement("th",{key:-1})],a=0;a<this.props.ctx.numPlayers;a++)t.push(o.a.createElement("th",{key:a},a));for(var n=[],r=["A","B","C"],s=0;s<r.length;s++){for(var i=r[s],c=[o.a.createElement("th",{key:"index"},i)],l=0;l<this.props.ctx.numPlayers;l++){var u="";l+""==this.props.ctx.currentPlayer&&i==this.props.ctx.phase&&(u="active"),c.push(o.a.createElement("td",{key:l,className:u}))}n.push(o.a.createElement("tr",{key:i},c))}return o.a.createElement("div",{className:"diagram"},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,t)),o.a.createElement("tbody",null,n)),o.a.createElement("div",{className:"buttons"},o.a.createElement("button",{onClick:function(){return e.props.events.endTurn()}},"endTurn"),o.a.createElement("button",{onClick:function(){return e.props.events.endPhase()}},"endPhase")))}}]),t}(o.a.Component)})}]}),Ea=ct({name:"secret-state",setup:function(){return{other:{},players:{0:"player 0 state",1:"player 1 state",2:"player 2 state"}}},moves:{clickCell:function(e){return Object(p.a)({},e)}},playerView:lt.STRIP_SECRETS}),Ca=(a(133),Re({game:Ea,numPlayers:3,board:function(e){var t=e.G,a=e.ctx,n=e.moves,r=e.playerID;return o.a.createElement("div",{className:"secret-state"},o.a.createElement("section",null,o.a.createElement("pre",null,JSON.stringify(t,null,2)),r&&o.a.createElement("button",{onClick:function(){return n.clickCell({secret:t.players[a.currentPlayer]})}},"Click Cell")))},debug:!1,multiplayer:{local:!0}})),xa={routes:[{path:"/liars-dice",text:"Examples",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement("h1",null,"Secret Info"),o.a.createElement("div",{className:"runner"},o.a.createElement("div",{className:"run"},o.a.createElement(Ca,{gameID:"secret-state",playerID:"0"}),'<App playerID="0"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(Ca,{gameID:"secret-state",playerID:"1"}),'<App playerID="1"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(Ca,{gameID:"secret-state",playerID:"2"}),'<App playerID="2"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(Ca,{gameID:"secret-state"}),"<App/>")))}}]},wa=Re({game:ct({name:"shuffle",setup:function(){return{deck:["a","b","c","d","e","f","g","h"]}},moves:{shuffle:function(e,t){return Object(p.a)({},e,{deck:t.random.Shuffle(e.deck)})},rollDie:function(e,t,a){return Object(p.a)({},e,{dice:t.random.Die(a)})},rollD6:function(e,t){return Object(p.a)({},e,{dice:t.random.D6()})}}}),numPlayers:1,board:function(e){var t=e.G,a=e.moves;return o.a.createElement("div",null,o.a.createElement("pre",null,JSON.stringify(t,null,2)),o.a.createElement("button",{onClick:function(){return a.shuffle()}},"shuffle"),o.a.createElement("button",{onClick:function(){return a.rollD6()}},"roll"))}}),Da={routes:[{path:"/random/main",text:"Examples",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(wa,{gameID:"Random"}))}}]},Ma={description:function(){return o.a.createElement("div",null)},game:ct({})},Ia={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    phases: {\n      A: { turnOrder: TurnOrder.ONCE },\n      B: {},\n    },\n  },\n}\n"))},game:ct({flow:{endPhase:!1,startingPhase:"A",phases:{A:{turnOrder:st.ONCE,next:"B"},B:{}}}})},Pa={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    turnOrder: TurnOrder.CUSTOM(['1', '0', '2', '3', '5', '4']),\n  },\n}\n"))},game:ct({flow:{endPhase:!1,turnOrder:st.CUSTOM(["1","0","2","3","5","4"])}})},_a={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  setup: () => ({\n    order: ['1', '0', '2', '3', '5', '4'],\n  }),\n\n  flow: {\n    turnOrder: TurnOrder.CUSTOM_FROM('order'),\n  },\n}\n"))},game:ct({setup:function(){return{order:["1","0","2","3","5","4"]}},flow:{endPhase:!1,turnOrder:st.CUSTOM_FROM("order")}})},Sa={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    turnOrder: TurnOrder.ANY,\n  },\n}\n"))},game:ct({moves:{move:function(e){return e}},flow:{endTurn:!1,endPhase:!1,turnOrder:st.ANY}})},La={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    startingPhase: 'A',\n    phases: {\n      A: { turnOrder: TurnOrder.ANY_ONCE, next: 'B' },\n      B: { allowedMoves: [] },\n    }\n  },\n}\n"))},game:ct({moves:{move:function(e){return e}},flow:{endTurn:!1,endPhase:!1,startingPhase:"A",phases:{A:{turnOrder:st.ANY_ONCE,next:"B"},B:{allowedMoves:[]}}}})},Na={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    turnOrder: TurnOrder.OTHERS,\n  },\n}\n"))},game:ct({moves:{move:function(e){return e}},flow:{endPhase:!1,turnOrder:st.OTHERS}})},Ta={description:function(){return o.a.createElement("div",null,o.a.createElement("pre",null,"{\n  flow: {\n    startingPhase: 'play',\n\n    phases: {\n      play: {\n        allowedMoves: ['play'],\n      },\n\n      discard: {\n        turnOrder: TurnOrder.OTHERS_ONCE,\n        allowedMoves: ['discard'],\n      },\n    },\n  },\n\n  moves: {\n    play(G, ctx) {\n      ctx.events.endPhase({ next: 'discard' });\n      return G;\n    },\n\n    discard(G) {\n      return G;\n    },\n  },\n}\n"))},game:ct({flow:{endPhase:!1,startingPhase:"play",phases:{play:{allowedMoves:["play"]},discard:{turnOrder:st.OTHERS_ONCE,allowedMoves:["discard"]}}},moves:{play:function(e,t){return t.events.endPhase({next:"discard"}),e},discard:function(e){return e}}})},Ga=(a(135),function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){var e=this;if(null===this.props.playerID)return o.a.createElement("div",{className:"table-interior"},o.a.createElement("label",null,"phase"),o.a.createElement("div",{className:"phase"},this.props.ctx.phase));var t="player",a=!1,n=!1;this.props.ctx.actionPlayers.includes(this.props.playerID)&&(t+=" active",a=!0),this.props.playerID==this.props.ctx.currentPlayer&&(t+=" current",n=!0);var r=Object.entries(this.props.moves).filter(function(t){return null===e.props.ctx.allowedMoves||e.props.ctx.allowedMoves.includes(t[0])}).map(function(e){return o.a.createElement("button",{key:e[0],onClick:function(){return e[1]()}},e[0])}),s=Object.entries(this.props.events).filter(function(){return n&&a}).filter(function(e){return"setActionPlayers"!=e[0]}).map(function(e){return o.a.createElement("button",{key:e[0],onClick:function(){return e[1]()}},e[0])});return o.a.createElement("div",{className:"player-wrap"},o.a.createElement("span",{className:t,onClick:function(){}},this.props.playerID),o.a.createElement("div",{className:"controls"},a&&r,s))}}]),t}(o.a.Component)),Aa={default:Ma,"others-once":Ta,once:Ia,custom:Pa,"custom-from":_a,any:Sa,"any-once":La,others:Na},Ra={routes:[{path:"/turnorder/main",text:"Simulator",component:function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).init("default"),a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"init",value:function(e){this.type=e,this.description=Aa[e].description,this.client=Re({game:Aa[e].game,numPlayers:6,debug:!1,board:Ga,multiplayer:{local:!0}}),this.forceUpdate()}},{key:"render",value:function(){for(var e=this,t=this.description,a=this.client,n=[],r=0;r<6;r++)n.push(o.a.createElement(a,{key:r,playerID:r+""}));return o.a.createElement("div",{id:"turnorder"},o.a.createElement("div",{className:"turnorder-options"},o.a.createElement("div",{className:"default"===this.type?"active":"",onClick:function(){return e.init("default")}},"DEFAULT"),o.a.createElement("div",{className:"once"===this.type?"active":"",onClick:function(){return e.init("once")}},"ONCE"),o.a.createElement("div",{className:"any"===this.type?"active":"",onClick:function(){return e.init("any")}},"ANY"),o.a.createElement("div",{className:"any-once"===this.type?"active":"",onClick:function(){return e.init("any-once")}},"ANY_ONCE"),o.a.createElement("div",{className:"others"===this.type?"active":"",onClick:function(){return e.init("others")}},"OTHERS"),o.a.createElement("div",{className:"others-once"===this.type?"active":"",onClick:function(){return e.init("others-once")}},"OTHERS_ONCE"),o.a.createElement("div",{className:"custom"===this.type?"active":"",onClick:function(){return e.init("custom")}},"CUSTOM"),o.a.createElement("div",{className:"custom-from"===this.type?"active":"",onClick:function(){return e.init("custom-from")}},"CUSTOM_FROM")),o.a.createElement("div",{className:"turnorder-content"},o.a.createElement("div",{className:"player-container"},o.a.createElement(a,null),o.a.createElement("span",null,n)),o.a.createElement("div",{className:"description"},o.a.createElement(t,null))))}}]),t}(o.a.Component)}]};function za(e,t){return function(a){console.log(e+": "+JSON.stringify(a)),t&&t(a)}}var qa=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).onDrop=function(e){a.setState(function(t){return{deck:[].concat(Object(ce.a)(t.deck.filter(function(t){return t!=e})),[e]),free:null}})},a.state={deck:[],free:!0},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{style:{marginBottom:20}},"Drag the card into the deck"),o.a.createElement(Tt,{three:!0},o.a.createElement(Zt,{onDrop:za("deck onDrop",this.onDrop),onClick:za("deck onClick")},this.state.deck.map(function(e){return o.a.createElement(Bt,{key:e,data:e,back:e,onClick:za("card onClick")})})),this.state.free&&o.a.createElement(Bt,{data:1,back:1,onClick:za("card1 onClick")})))}}]),t}(o.a.Component),Fa=Re({game:ct({}),board:qa,debug:!1}),Ua=function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(Fa,{gameID:"single"}))},Ba=a(34),Ha=a.n(Ba),Wa=a(35),Ya=a.n(Wa),Va=(a(62),a(63),window.THREE=a(13));a(64);var Za=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e))).onClick=function(e){var t=e.x,a=e.y;console.log(t+" "+a)},a.state={deck:[],free:!0,loading:!0},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loader=new Va.GLTFLoader,this.loader.load(Ha.a,function(t){t=t.scene.children[0],e.setState({bishop:t})}),this.loader.load(Ya.a,function(t){t=t.scene.children[0],e.setState({knight:t})})}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{style:{marginBottom:20}},"Showing chess pieces on the grid"),o.a.createElement(Tt,{three:!0},o.a.createElement(ea,{rows:8,cols:8,onClick:this.onClick},o.a.createElement(sa,{x:3,y:3,mesh:this.state.knight,onClick:this.onClick,key:1}),o.a.createElement(sa,{x:2,y:3,size:.7,mesh:this.state.bishop,onClick:this.onClick,key:2}))))}}]),t}(o.a.Component),Ja=Re({game:ct({}),board:Za,debug:!1}),Xa=function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(Ja,{gameID:"single"}))};function Ka(e){var t=null;return(t=wt.a.Chess?new wt.a.Chess:new wt.a).load_pgn(e),t}var Qa=ct({name:"chess",setup:function(){return{pgn:""}},moves:{move:function(e,t,a){var n=Ka(e.pgn);return"w"==n.turn()&&"1"==t.currentPlayer||"b"==n.turn()&&"0"==t.currentPlayer?Object(p.a)({},e):(n.move(a),{pgn:n.pgn()})}},flow:{movesPerTurn:1,endGameIf:function(e){var t=Ka(e.pgn);if(t.game_over()){if(t.in_draw()||t.in_threefold_repetition()||t.insufficient_material()||t.in_stalemate())return"d";if(t.in_checkmate())return"w"==t.turn()?"b":"w"}}}}),$a=function(e){function t(){var e,a;Object(f.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(y.a)(this,(e=Object(b.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){var t=e.x,n=e.y;a.props.onClick({square:a._cartesianToAlgebraic(t,n)})},a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"render",value:function(){for(var e=this,t=o.a.Children.map(this.props.children,function(t){var a=t.props.square,n=e._algebraicToCartesian(a),r=n.x,s=n.y;return o.a.cloneElement(t,{x:r,y:s,onClick:function(a){var n=a.x,r=a.y;t.props.onClick({square:e._cartesianToAlgebraic(n,r)})}})}),a={},n=0;n<this.props.cols;n++)for(var r=0;r<this.props.rows;r++){var s="".concat(n,",").concat(r),i=this.props.secondaryColor;(n+r)%2==0&&(i=this.props.primaryColor),a[s]=i}for(var c in this.props.highlightedSquares){var l=this._algebraicToCartesian(c),u=l.x,p=l.y;a["".concat(u,",").concat(p)]=this.props.highlightedSquares[c]}return o.a.createElement(Tt,{three:!0},o.a.createElement(ea,{rows:this.props.rows,cols:this.props.cols,padding:0,onClick:this.onClick,colorMap:a},t))}},{key:"_algebraicToCartesian",value:function(e){var t=/([A-Za-z])(\d+)/g.exec(e);if(null==t)throw"Invalid square provided: "+e;var a=t[1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),n=parseInt(t[2]);return{x:a,y:this.props.rows-n}}},{key:"_cartesianToAlgebraic",value:function(e,t){return String.fromCharCode(e+"a".charCodeAt(0))+(this.props.rows-t)}}]),t}(o.a.Component);$a.defaultProps={rows:8,cols:8,onClick:function(){},primaryColor:"#d18b47",secondaryColor:"#ffce9e",highlightedSquares:{},style:{}};var en=$a,tn=a(70),an=a.n(tn),nn=(a(137),a(71)),rn=a.n(nn),on=(a(138),a(72)),sn=a.n(on),cn=(a(139),a(73)),ln=a.n(cn),un=(a(140),window.THREE=a(13));a(64);var pn=Re({game:Qa,board:function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(y.a)(this,Object(b.a)(t).call(this,e)))._handleMesh=function(e,t){e=e.scene.children[0];var n={};n[t]=e;var r=(new un.Box3).setFromObject(e),o=new un.Vector3;r.getSize(o),n[t].realSize=o.x,a.setState(n)},a.state={selected:"",mesh:{},loading:!0},a.click=function(e){var t=e.square;if(a.props.isActive)if(!a.state.selected&&a._isSelectable(t))a.setState({selected:t});else if(a.state.selected){var n=a._getMoves().find(function(e){return e.from==a.state.selected&&e.to==t});n&&a.props.moves.move(n.san),a.setState({selected:""})}},a.chess=new wt.a,a.loader=new un.GLTFLoader,a}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loader.load(Ha.a,function(t){return e._handleMesh(t,"bishop")}),this.loader.load(an.a,function(t){return e._handleMesh(t,"king")}),this.loader.load(Ya.a,function(t){return e._handleMesh(t,"knight")}),this.loader.load(rn.a,function(t){return e._handleMesh(t,"pawn")}),this.loader.load(sn.a,function(t){return e._handleMesh(t,"queen")}),this.loader.load(ln.a,function(t){return e._handleMesh(t,"rook")})}},{key:"componentWillReceiveProps",value:function(e){e.G.pgn&&(this.chess.load_pgn(e.G.pgn),this.setState({selected:""}))}},{key:"render",value:function(){void 0!==this.props.G.pgn&&this.chess.load_pgn(this.props.G.pgn);var e=null;return this.props.isMultiplayer&&!this.props.isConnected&&(e=o.a.createElement("p",null,"Disconnected!")),o.a.createElement("div",null,o.a.createElement(en,{highlightedSquares:this._getHighlightedSquares(),style:{width:"400px"},onClick:this.click},this._getPieces()),this._getStatus(),e)}},{key:"_getHighlightedSquares",value:function(){var e={};this.state.selected&&(e[this.state.selected]="green");var t=!0,a=!1,n=void 0;try{for(var r,o=this._getMoves()[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){e[r.value.to]="palegreen"}}catch(s){a=!0,n=s}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}return e}},{key:"_getLargest",value:function(){var e=-1/0,t=!0,a=!1,n=void 0;try{for(var r,o="bknpqr"[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,i=this._pieceShortToLong(s);e=this.state[i].realSize>e?this.state[i].realSize:e}}catch(c){a=!0,n=c}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}this._maxRealSize=e}},{key:"_getSize",value:function(e){var t=!0,a=!1,n=void 0;try{for(var r,o="bknpqr"[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,i=this._pieceShortToLong(s);if(!this.state[i])return null}}catch(l){a=!0,n=l}finally{try{t||null==o.return||o.return()}finally{if(a)throw n}}var c=this._pieceShortToLong(e);return this._maxRealSize||this._getLargest(),this.state[c].realSize/this._maxRealSize}},{key:"_pieceShortToLong",value:function(e){switch(e){case"b":return"bishop";case"k":return"king";case"n":return"knight";case"p":return"pawn";case"q":return"queen";case"r":return"rook"}}},{key:"_getPieces",value:function(){for(var e=[],t=1;t<=8;t++)for(var a=0;a<8;a++){var n="abcdefgh"[a]+t,r=this.chess.get(n);r&&e.push(o.a.createElement(sa,{square:n,animate:!0,size:this._getSize(r.type),key:this._getInitialCell(n),onClick:this.click.bind(this),mesh:this._getPieceByTypeAndColor(r.type,r.color)}))}return e}},{key:"_getPieceByTypeAndColor",value:function(e,t){var a,n=this._pieceShortToLong(e);if(a=this.state[n]){var r=a.clone(),o=new un.MeshLambertMaterial({color:5592405}),s=new un.MeshLambertMaterial({color:15658734});return"b"==t?("bishop"==n&&r.rotateOnWorldAxis(new un.Vector3(0,1,0),Math.PI),r.traverse(function(e){e.material&&(e.material=o)})):("bishop"!=n&&r.rotateOnWorldAxis(new un.Vector3(0,1,0),Math.PI),r.traverse(function(e){e.material&&(e.material=s)})),r}return null}},{key:"_getStatus",value:function(){var e=null;if(this.chess.in_check()&&(e="CHECK"),this.props.ctx.winner)switch(this.props.ctx.winner){case"b":e="Black won!";break;case"w":e="White won!";break;case"d":e="Draw!"}if(e)return o.a.createElement("p",null,o.a.createElement("strong",null,e))}},{key:"_getInitialCell",value:function(e){for(var t=this.chess.history({verbose:!0}),a=e,n=t.length-1;n>=0;n--){var r=t[n];a==r.to&&(a=r.from)}return a}},{key:"_isSelectable",value:function(e){var t=this.chess.get(e);return t&&t.color===this._getCurrentPlayer()&&this.chess.moves({square:e}).length>0}},{key:"_getCurrentPlayer",value:function(){return 0==this.props.ctx.currentPlayer?"w":"b"}},{key:"_getMoves",value:function(){return this.state.selected?this.chess.moves({verbose:!0,square:this.state.selected}):[]}}]),t}(o.a.Component)}),hn={routes:[{path:"/ui/2d",text:"Drag and Drop",component:Ua},{path:"/ui/3d",text:"3D Grid",component:Xa},{path:"/ui/chess3d",text:"Chess 3D",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement(pn,{gameID:"single"}))}}]},dn=a(18);a(141);var mn={routes:[{path:"/threejs/main",text:"threejs",component:function(e){function t(){return Object(f.a)(this,t),Object(y.a)(this,Object(b.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(v.a)(t,[{key:"componentDidMount",value:function(){!function(e){var t=Ae({game:pt}),a=new dn.i;a.background=new dn.c(16777215);var n=new dn.k({antialias:!0});n.setSize(window.innerWidth,window.innerHeight);for(var r=[],o=0;o<9;o++){var s=new dn.b(1,1,1),i=new dn.f({color:13421772}),c=new dn.e(s,i),l=Math.floor(o/3),u=o%3;c.position.z=2*-u,c.position.x=2*l,c.userData.i=o,r.push(c),a.add(c)}var p=new dn.g(45,window.innerWidth/window.innerHeight,.1,1e3);p.position.z=5,p.position.x=12,p.position.y=15,p.lookAt(r[4].position),a.add(p);var h=new dn.a(16777215,.7);a.add(h);var d=new dn.d(5592405);a.add(d);var m=0,f=new dn.j,v=new dn.h;e.appendChild(n.domElement),e.addEventListener("mousemove",function(a){if(void 0===t.getState().ctx.gameover){var n=a.clientX-e.offsetParent.offsetLeft,o=a.clientY;f.x=n/window.innerWidth*2-1,f.y=-o/window.innerHeight*2+1,v.setFromCamera(f,p);var s=v.intersectObjects(r);r.forEach(function(e){e.material.color.setHex(13421772)}),s.forEach(function(e){e.object.material.color.setHex(11184810)}),s.length>0?e.style.cursor="pointer":e.style.cursor=""}else e.style.cursor=""}),e.addEventListener("mousedown",function(){v.setFromCamera(f,p),v.intersectObjects(r).forEach(function(e){t.moves.clickCell(e.object.userData.i)})}),function e(){requestAnimationFrame(e);var o=t.getState().G;r.filter(function(e){return"0"==o.cells[e.userData.i]}).forEach(function(e){e.material.color.setHex(16711680),e.rotation.x=m}),r.filter(function(e){return"1"==o.cells[e.userData.i]}).forEach(function(e){e.material.color.setHex(65280),e.rotation.y=-m}),m+=.03,n.render(a,p)}()}(this.ref)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{ref:function(t){e.ref=t}})}}]),t}(o.a.Component)}]};a(143);pt.minPlayers=1,pt.maxPlayers=2,Mt.minPlayers=Mt.maxPlayers=2;var fn=[{game:pt,board:ht},{game:Mt,board:va}],vn={routes:[{path:"/lobby/main",text:"Example",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement("h1",null,"Lobby"),o.a.createElement(Xe,{gameServer:"http://localhost:8000",lobbyServer:"http://localhost:8000",gameComponents:fn}))}}]},yn=ct({name:"secret-state",setup:function(){return{other:{},players:{0:"player 0 state",1:"player 1 state"}}},moves:{clickCell:function(e,t,a){return Object(p.a)({},e)}},flow:{redactedMoves:["clickCell"],turnOrder:st.ANY},playerView:lt.STRIP_SECRETS}),bn=(a(145),Re({game:yn,numPlayers:2,board:function(e){var t=e.G,a=e.ctx,n=e.moves,r=e.playerID,s=e.log;return o.a.createElement("div",{className:"secret-state"},o.a.createElement("section",null,o.a.createElement("strong",null,"G"),o.a.createElement("pre",null,JSON.stringify(t,null,2)),o.a.createElement("strong",null,"log"),o.a.createElement("pre",null,JSON.stringify(s,null,2)),r&&o.a.createElement("button",{onClick:function(){return n.clickCell({secret:t.players[a.currentPlayer]})}},"Click Cell")))},debug:!1,multiplayer:{local:!0}})),gn=[{name:"Tic-Tac-Toe",routes:Ct.routes},{name:"Chess",routes:Oa.routes},{name:"Phases",routes:ka.routes},{name:"Turn Orders",routes:Ra.routes},{name:"Random API",routes:Da.routes},{name:"Secret State",routes:xa.routes},{name:"Redacted Move",routes:{routes:[{path:"/redacted_move",text:"Example",component:function(){return o.a.createElement("div",{style:{padding:50}},o.a.createElement("h1",null,"Redacted Moves"),o.a.createElement("p",null,"This examples demonstrates the use of redacted moves. Using redacted moves allows for secret information to be stripped from the log for other players."),o.a.createElement("p",null,"Clicking the button on one of the players, you should see complete log event for that player but a redacted one for everyone else."),o.a.createElement("div",{className:"runner"},o.a.createElement("div",{className:"run"},o.a.createElement(bn,{gameID:"redacted-move",playerID:"0"}),'<App playerID="0"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(bn,{gameID:"redacted-move",playerID:"1"}),'<App playerID="1"/>'),o.a.createElement("div",{className:"run"},o.a.createElement(bn,{gameID:"redacted-move"}),"<App/>")))}}]}.routes},{name:"UI",routes:hn.routes},{name:"Other Frameworks",routes:mn.routes},{name:"Lobby",routes:vn.routes}];a(147);Object(s.render)(o.a.createElement(function(){return o.a.createElement(i.a,null,o.a.createElement("main",null,o.a.createElement("aside",{className:"sidebar"},o.a.createElement("div",{className:"sidebar-nav",style:{height:"90%"}},o.a.createElement("ul",null,gn.map(function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("p",null,e.name),o.a.createElement("ul",null,e.routes.map(function(e,a){return o.a.createElement(m,{key:"".concat(t,".").concat(a),to:e.path,exact:!0,activeClassName:"active"},e.text)})))})))),o.a.createElement("section",{className:"content"},u.a.flattenDeep(gn.map(function(e){return e.routes})).map(function(e,t){return o.a.createElement(c.a,{key:t,exact:!0,path:e.path,component:e.component})}))))},null),document.getElementById("test")||document.createElement("div"))},34:function(e,t,a){e.exports=a.p+"static/media/bishop.47a8aa26.gltf"},35:function(e,t,a){e.exports=a.p+"static/media/knight.27e1a7c1.gltf"},37:function(e,t,a){},62:function(e,t,a){e.exports=a.p+"static/media/bishop.bin"},63:function(e,t,a){e.exports=a.p+"static/media/knight.bin"},70:function(e,t,a){e.exports=a.p+"static/media/king.550daf5d.gltf"},71:function(e,t,a){e.exports=a.p+"static/media/pawn.a53672c6.gltf"},72:function(e,t,a){e.exports=a.p+"static/media/queen.c56b877d.gltf"},73:function(e,t,a){e.exports=a.p+"static/media/rook.67461314.gltf"},75:function(e,t,a){e.exports=a(149)},88:function(e,t,a){}},[[75,2,1]]]);
//# sourceMappingURL=main.40a8f058.chunk.js.map